<div class="module_doc">
    <div class="tagname"><tt>&lt;<%=@moduleName%>&gt;</tt></div>
    <table class="metadata">
        <tr>
            <td class="key">Module Name</td>
            <td class="value name"><strong><%=@name%></strong></td>
        </tr>
        <tr>
            <td class="key">Element</td>
            <td class="value element"><tt>&lt;<%=@moduleName%>&gt;</tt></td>
        </tr>
        <tr>
            <td class="key">Author</td>
            <td class="value author"><%=@author%></td>
        </tr>
        <tr>
            <td class="key">Homepage</td>
            <td class="value homepage"><a href="<%= @moduleURL %>"><%= @moduleURL %></a></td>
        </tr>
        <tr>
            <td class="key">Description</td>
            <td class="value description"><%=@description%></td>
        </tr>
    </table>
    <div class="module_menu">
        <ul>
            <%
                requiredcount=0
                optionalcount=0
                @attributes.each do |attr| 
                    if not attr['optional'] 
                        requiredcount+=1 
                    else 
                        optionalcount+=1 
                    end
                end
            %>
            <li class="active" on="click then set[class=active] and l:show[name=required] or l:show[name!=required] then remove[class=active]">Required Attributes <span>(<%=requiredcount%>)</span></li>
            <li on="click then set[class=active] and l:show[name=optional] or l:show[name!=optional] then remove[class=active]">Optional Attributes <span>(<%=optionalcount%>)</span></li>
            <li on="click then set[class=active] and l:show[name=example] or l:show[name!=example] then remove[class=active]">Examples <span>(<%=@examples.length%>)</span></li>
            <li on="click then set[class=active] and l:show[name=src] or l:show[name!=src] then remove[class=active]">Source code</li>
        </ul>
        <div class="clear"></div>
    </div>
    <div class="attributes">
        <div>
            <table class="required" on="l:show[name=required] then effect[appear,delay=0,duration=0.3] else hide">
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Description</th>
                    <th>Default value</th>
                </tr>
                <%
                    idx=0
                    @attributes.each do |attr|
                        if not attr['optional']
                          classname=(idx % 2) == 0 ? 'even' : 'odd'
                          idx+=1
                          classname << ' last' if idx == @attributes.length
                        %>
                        <tr>
                        <%= "   <td class=\"#{classname}\">#{attr['name']}</td>\n" %>
                        <%
                            name = 'Unknown'
                            if attr['type']
                                name=attr['type']['name']
                                if name == 'Enumeration'
                                    name = "Enumeration of: " + attr['type']['values'].join(', ')
                                end
                            end
                        %>
                        <%= " "*40 + "   <td class=\"#{classname}\">#{name}</td>\n" %>
                        <%= " "*40 + "   <td class=\"#{classname}\">#{attr['description']||'Not specified'}</td>\n" %>
                        <%= " "*40 + "   <td class=\"#{classname}\">#{attr['defaultValue']||'Not specified'}</td>" %>
                        </tr>
                        <%
                        end
                    end
                    if idx < 1
                        %>
                        <tr><td colspan="4">There are no required attributes</td></tr>
                        <%
                    end
                %>
            </table>
            <table class="optional" style="display:none" on="l:show[name=optional] then effect[appear,delay=0,duration=0.3] else hide">
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Description</th>
                    <th>Default value</th>
                </tr>
                <%
                    idx = 0
                    @attributes.each do |attr|
                        if attr['optional']
                          classname=(idx % 2) == 0 ? 'even' : 'odd'
                          idx+=1
                          classname << ' last' if idx == @attributes.length
                        %>
                        <tr>
                        <%= "   <td class=\"#{classname}\">#{attr['name']}</td>\n" %>
                        <%
                            name = 'Unknown'
                            if attr['type']
                                name=attr['type']['name']
                                if name == 'Enumeration'
                                    name = "Enumeration of: " + attr['type']['values'].join(', ')
                                end
                            end
                        %>
                        <%= " "*40 + "   <td class=\"#{classname}\">#{name}</td>\n" %>
                        <%= " "*40 + "   <td class=\"#{classname}\">#{attr['description']||'Not specified'}</td>\n" %>
                        <%= " "*40 + "   <td class=\"#{classname}\">#{attr['defaultValue']||'Not specified'}</td>" %>
                        </tr>
                        <%
                        end
                    end
                    if idx < 1
                        %>
                        <tr><td colspan="4">There are no optional attributes</td></tr>
                        <%
                    end
                %>
            </table>
            <div style="display:none" on="l:show[name=example] then effect[appear,delay=0,duration=0.3] else hide">
                <div class="module_body examples">
                    <ul>
                    <%
                        code = ''
                        @examples.each_with_index do |example,idx|
                            %><li>&raquo; <a href="#example_<%=idx%>" onclick="return false;" on="click then effect[scrollTo,id=example_<%=idx%>] and effect[highlight,id=example_<%=idx%>,delay=0.8]"><%= example[:title] %></a></li><%
                            code << "<div class=\"examplecode\"><a class=\"up\" on=\"click then effect[scrollTo,id=app_body]\">Back to menu</a>"
                            code << "<a class=\"title\" name=\"example_#{idx}\" id=\"example_#{idx}\">Example: #{example[:title]}</a>"
                            code << "<div id=\"example_code_#{idx}\">#{example[:code]}</div>"
                            code << "</div>"
                        end
                        code = '<li>There are currently no examples</li>' if @examples.length < 1
                    %>
                    </ul>
                    <%=code%>
                </div>
            </div>
            <div style="display:none" on="l:show[name=src] then effect[appear,delay=0,duration=0.3] else hide">
                <div class="module_body sourcecode"><%=@sourcecode%></div>
            </div>
        </div>
    </div>
</div>
