<html>
<body>

	<div class="header_bar">Service Bundles
		(<span on="r:$appcelerator.servicebundle.query.response then value[count]"></span> total)
		<span class="refresh" on="click then r:$appcelerator.servicebundle.query.request
			or r:$appcelerator.servicebundle.query.request then hide
			or r:$appcelerator.servicebundle.query.response then show">
			<img src="images/arrow_refresh.png" style="position:relative;top:3px"/>
			<a>Refresh</a>
		</span>
		<span class="refresh_indicator" on="r:$appcelerator.servicebundle.query.request then show
			or r:$appcelerator.servicebundle.query.response then hide" 
			style="display:none">Reloading...
		</span>
	</div>

	<img src="images/pencil.png"/><span style="font-size:13px;color:#555">Click row to edit</span>
	<div style="padding:7px"></div>

	<!-- EDIT BOX -->
	<div class="edit_box" on="l:service.edit.show then effect[Appear] 
		or l:service.edit.close then effect[Fade]
		or r:$appcelerator.servicebundle.edit.response then effect[Fade]" style="display:none">
		Currently Editing: <b>
		<span on="l:service.edit.show then value[name]" style="padding-right:8px"></span></b>								
		Change Active Version:
		<select on="l:service.edit.show then value[property=releases,text=release,value=release]
		 	or l:service.edit.show then selectOption[version]" fieldset="service_bundle"
			id="service_bundle_version">
		</select>
		Change Bundle Status:
		<select on="l:service.edit.show then selectOption[status]" fieldset="service_bundle"
			id="service_bundle_status">
			<option value="Active">Active</option>
			<option value="In-Active">In-Active</option>
		</select>
		<input type="hidden" id="service_bundle_name"
			on="l:service.edit.show then value[name]" fieldset="service_bundle"/>
		<input type="button" value="Save" fieldset="service_bundle"
			on="click then r:$appcelerator.servicebundle.edit.request"/>
		<input type="button" value="Cancel" on="click then l:service.edit.close"/>	
		<img src="images/indicator.gif" on="r:$appcelerator.servicebundle.edit.request then show
		 or r:$appcelerator.servicebundle.edit.response then hide" 
		style="display:none;position:relative;top:3px">							
	</div>
	
	<!-- SERVICE BUNDLE ITERATOR -->
	<div style="height:350px;overflow:auto">
		<app:iterator on="r:$appcelerator.servicebundle.query.response then execute after 500ms" 
			property="services">
			<html:div class="service_row" 
				on="click then l:service.row.selected[idx=#{iterator_index}] or r:$appcelerator.servicebundle.edit.response[name='#{name}'] then effect[Pulsate]
				or r:$appcelerator.servicebundle.query.response then effect[drop-out]">
				<html:div class="service_doc">				
					#{name} 
				</html:div>
				<html:div class="service_version">
					<html:span class="app_service_status" id="service_status_#{iterator_index}"
					on="r:$appcelerator.servicebundle.edit.response[name='#{name}'] then value[status]">
					#{status}																				
					</html:span>
					<html:img src="images/layers.png"></html:img>
					 version 
					<html:span 
on="r:$appcelerator.servicebundle.edit.response[name='#{name}'] then value[version]">#{active}</html:span>.0 
				</html:div>
			</html:div>
			<html:input type="hidden" id="sb_status_#{iterator_index}" value="#{status}"
				on="r:$appcelerator.servicebundle.edit.response[name='#{name}'] then value[status]">
			</html:input>
			<html:input type="hidden" id="sb_version_#{iterator_index}" value="#{active}"
				on="r:$appcelerator.servicebundle.edit.response[name='#{name}'] then value[version]">
			</html:input>
			<app:script on="l:service.row.selected[idx=#{iterator_index}] then execute">
			var status = $('sb_status_#{iterator_index}').value;
			var version = $('sb_version_#{iterator_index}').value;										
			$MQ('l:service.edit.show',{'releases':#{releases},'name':'#{name}','status':status,'version':version});
			</app:script>
		</app:iterator>
	</div>

	<app:message name="r:$appcelerator.servicebundle.query.request" interval="300000">
	</app:message>
	
</body>
</html>