<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	"http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:app="http://www.appcelerator.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<script type="text/javascript" src="js/appcelerator.js"></script>
</head>
<body>
	<div on="main[login] then show else hide" style="display:none;">
		<div on="login[out] then hide else show" style="display:none;">
			<div class="forums_container" on="l:showlogout.request then show or l:showaccount.request then hide" style="display:none;">
				<table style="background-color:#f6f6f6;padding:10px;border:1px dashed #bbb">
					<tr>
						<input type="hidden" id="myfavoriteid" name="name1" value="22" fieldset="logout">
						<td colspan="2" align="left" >
							<input type="button" value="logout" fieldset="logout" style="margin-top:10px" on="click then r:logout.request"/>
						</td>
					</tr>
				</table>
			</div>
			<div class="forums_container" on="l:showaccount.response then show or l:showlogout.request then hide" style="display:none;">
				<h1 style="margin-top:0;" on="l:showaccount.response then value[user.fullName]"></h1>
				<p class="subtitle">
				<span on="l:showaccount.response then value[user.posts]"></span> post(s) 	(<a class="smalllink pointer" 
						on="click then r:threads.request[type=byuser,userid=expr(Forums.user.id)]">view threads</a>)
				</p>
				<div class="edittable">
					<form on="enter then click[id=save_account_button]">
					<table>
						<input type="hidden" fieldset="account" id="account_id" validator="required" decorator="required" on="l:showaccount.response then value[user.id]"/>
						<tr>
							<td class="bold_value_grey">
								name:
							</td>
							<td>
								<input type="text" fieldset="account" id="account_fullName" validator="required" decorator="required" on="l:showaccount.response then value[user.fullName]"/>
							</td>
						</tr>
						<tr>
							<td class="bold_value_grey">
								username:
							</td>
							<td>
								<input type="text" fieldset="account" id="account_username" validator="required" decorator="required" on="l:showaccount.response then value[user.username]"/>
							</td>
						</tr>
						<tr>
							<td class="bold_value_grey">
								email:
							</td>
							<td>
								<input type="text" fieldset="account" id="account_email" validator="required" decorator="required" on="l:showaccount.response then value[user.email]"/>
							</td>
						</tr>
						<tr>
							<td class="bold_value_grey">
								password:
							</td>
							<td>
								<input type="text" fieldset="account" id="account_password" validator="required" decorator="required" on="l:showaccount.response then value[user.password]"/>
							</td>
						</tr>
						<tr>
							<td colspan="2" align="left" >
								<input type="button" value="save account" fieldset="account" style="margin-top:10px" on="click then r:savaccount.request"
									activators="account_fullName,account_username,account_email,account_password"/ id="save_account_button">
							</td>
						</tr>
						<tr on="r:saveaccount.response then effect[appear] or l:showaccount.request then hide" style="display:none">
							<td colspan="2" align="left" >successfully saved account</td>
						</tr>
					</table>
					</form>
				</div>
			</div>
		</div>
		<div on="login[in] then hide else show or l:showlogin.request then show" style="display:none;">
			<div class="forums_container edittable">
				<form on="enter then click[id=login_button]">
				<table>
					<tr>
						<td class="bold_value_grey">
							username:
						</td>
						<td>
							<input type="text" fieldset="login" id="username" validator="required" decorator="required"/>
						</td>
					</tr>
					<tr>
						<td class="bold_value_grey">
							password:
						</td>
						<td>
							<input type="password" fieldset="login" id="password" validator="required" decorator="required"/>
						</td>
					</tr>
					<tr>
						<td colspan="2" align="left" >
							<input type="button" value="login" fieldset="login" style="margin-top:10px" on="click then r:login.request" activators="username,password" id="login_button"/>
						</td>
					</tr>
					<tr>
						<td colspan="2" align="left" on="r:login.failed.response then show or r:login.request then hide or login[in] then hide" style="display:none;">
							<span class="error">could not login with provided credentials</span>
						</td>
					</tr>
				</table>
				</form>
			</div>
			<div class="forums_container edittable">
				<form on="enter then click[id=signup_button]">
				<table>
					<tr>
						<td class="bold_value_grey">
							name:
						</td>
						<td>
							<input type="text" fieldset="signup" id="name" validator="required" decorator="required"  on="r:signup.response[success='true'] then clear"/>
						</td>
					</tr>
					<tr>
						<td class="bold_value_grey">
							username:
						</td>
						<td>
							<input type="text" fieldset="signup" id="signupusername" validator="required" decorator="required"  on="r:signup.response[success='true'] then clear"/>
						</td>
					</tr>
					<tr>
						<td class="bold_value_grey">
							email:
						</td>
						<td>
							<input type="text" fieldset="signup" id="email" validator="required" decorator="required"  on="r:signup.response[success='true'] then clear"/>
						</td>
					</tr>
					<tr>
						<td class="bold_value_grey">
							password:
						</td>
						<td>
							<input type="password" fieldset="signup" id="signuppassword" validator="required" decorator="required"  on="r:signup.response[success='true'] then clear"/>
						</td>
					</tr>
					<tr>
						<td colspan="2" align="left" >
							<input type="button" value="signup now!" fieldset="signup" style="margin-top:10px" on="click then r:signup.request" id="signup_button"
								activators="name,signupusername,email,signuppassword"/>
						</td>
					</tr>
				</table>
				</form>
			</div>
		</div>
	</div>
	<app:script on="r:login.response then execute or r:signup.response then execute">
		Forums.user = this.data.user;
		$MQ("l:showaccount.request",{});
	</app:script>
	<app:script on="l:showaccount.request then execute">
		$MQ("l:showaccount.response",{'user':Forums.user});
	</app:script>
	<app:script on="r:saveaccount.response then execute">
		Forums.user = this.data.user;
		$MQ("l:showaccount.response",{'user':Forums.user});
	</app:script>
</body>