<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	"http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:app="http://www.appcelerator.org">
<head>
<noscript><meta http-equiv="refresh" content="0;URL=upgrade_script.html"></noscript>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<title>AppXplorer by Appcelerator&trade;</title>
<script type="text/javascript" src="js/appcelerator.js"></script>
<link rel="stylesheet" type="text/css" href="css/forums.css" />
<link rel="stylesheet" type="text/css" href="css/header.css" />
</head>
<body>
	<div id="header">
	  <ul id="nav">
	    <li><a on="click then l:forums.request">Forums</a></li>
	    <li><a on="click then l:users.request">Users</a></li>
	    <li on="search[on] then show else hide">
			<input name="q" size="15" type="text" fieldset="search" />
		</li>
	    <li on="search[on] then show else hide">
			<a fieldset="search" on="click then l:search.request"/>go</a>
		</li>
	    <li><a on="click then l:showsearch.request or search[off] then show else hide">Search</a></li>
	    <li><a on="click then l:hidesearch.request or search[on] then show else hide">Dont Search</a></li>
        <li><a on="click then l:signup.request or login[out] then show else hide">Signup</a></li>
		<li><a on="click then l:login.request or login[out] then show else hide">Login</a></li>
	    <li><a on="click then l:logout.request or login[in] then show else hide" style="display:none">Logout</a>&nbsp;<span on="l:login.response then value[username] or l:signup.response then value[username] or login[in] then show else hide"></span></li>
		</ul>
	  <h1><a href="/">AppForums</a></h1>
	</div>
	<app:statemachine id="main" initial="forums">
		<state name="forums" if="l:forums.request or l:login.response or l:signup.response or l:logout.response"></state>
		<state name="search" if="l:search.request"></state>
		<state name="users" if="l:users.request"></state>
		<state name="signup" if="l:signup.request"></state>
		<state name="login" if="l:login.request"></state>
		<state name="logout" if="l:logout.request"></state>
	</app:statemachine>
	<app:statemachine id="login" initial="out">    
		<state name="out" if="l:logout.response"></state>
		<state name="in" if="l:login.response or l:signup.response"></state>
	</app:statemachine>
	<app:statemachine id="search" initial="off">    
		<state name="on" if="l:showsearch.request"></state>
		<state name="off" if="l:hidesearch.request"></state>
	</app:statemachine>
	<app:content src="content/forums.html" on="main[forums] then show else hide">
	</app:content>
	<app:script on="l:forum.request then execute">
		alert(this.data);
	</app:script>
	<app:script on="l:search.request then execute">
		alert("search parameters:" + this.data);
	</app:script>
	<app:script on="l:logout.request then execute">
		alert("simulating a successfull logout");
		$MQ("l:logout.response",{'success':'true'});
	</app:script>
	<app:script on="l:login.request then execute">
		var data={"id":"whatthefuck","success":"true","username":"maryann"};
		alert("simulating a successfull login as mary ann");
		$MQ("l:login.response",data);
	</app:script>
	<app:script on="l:signup.request then execute">
		alert("simulating a successfull signup as billybob");
		$MQ("l:signup.response",{"success":"true","username":"billybob"});
	</app:script>
</body>
</html>