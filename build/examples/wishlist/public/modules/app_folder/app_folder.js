Appcelerator.Module.Folder={modulePath:null,setPath:function(A){this.modulePath=A},getName:function(){return"appcelerator folder"},getDescription:function(){return"folder widget"},getVersion:function(){return 1},getSpecVersion:function(){return 1},getAuthor:function(){return"Jeff Haynie"},getModuleURL:function(){return"http://www.appcelerator.org"},isWidget:function(){return true},getWidgetName:function(){return"app:folder"},compileWidget:function(params){var itemCloser=function(exclude){params["itemnodes"].each(function(child){if(exclude!=child&&$(child).opened){$(child)._onclosed()}})};var closeChildren=function(parentid,childid){$A($(parentid+"_children").childNodes).findAll(function(n){return n.nodeType==1}).each(function(n){if(n.id!=childid){$(n.id)._onclosed()}})};var nodes=params["nodes"];for(var c=0;c<nodes.length;c++){(function(){var node=nodes[c];if(node.nodeType==1&&node.nodeName.toLowerCase()=="folder"){var parentid=node._parentid;var parentnode=$(parentid);node._children.each(function(child,b){var childid=child._childid;var open=child.getAttribute("open");var openaction=child.getAttribute("onopen");var closeaction=child.getAttribute("onclose");if(openaction){openaction=Appcelerator.Compiler.makeAction(childid,openaction)}if(closeaction){closeaction=Appcelerator.Compiler.makeAction(childid,closeaction)}if(open){var scriptcode="$('"+parentid+"')._onopened(); $('"+childid+"')._onopened();";Appcelerator.Compiler.handleCondition(child,open,"function["+scriptcode+"]",null,0,null)}$(childid)._onopened=function(){if(!$(childid).opened){itemCloser(childid);Element.removeClassName(childid+"_item","closed");Element.addClassName(childid+"_item","opened");$(childid).opened=true;Element.hide(childid+"_closed");Element.show(childid+"_opened");closeChildren(parentid,childid);if(openaction){eval(openaction)}}};$(childid)._onclosed=function(){if($(childid).opened){$(childid).opened=false;Element.removeClassName(childid+"_item","open");Element.addClassName(childid+"_item","closed");Element.hide(childid+"_opened");Element.show(childid+"_closed");if(closeaction){eval(closeaction)}}};$(childid+"_closed").onclick=function(){$(childid)._onopened()};$(childid+"_opened").onclick=function(){$(childid)._onclosed()};$(childid).onclick=function(e){e=Event.getEvent(e);e.stop();if($(childid).opened){$(childid)._onclosed()}else{$(childid)._onopened()}};$(childid)._onclosed()});$(parentid+"_closed").onclick=function(){parentnode.opened=true;Element.hide(parentid+"_closed");Element.show(parentid+"_opened");Element.toggle(parentid+"_children")};$(parentid+"_opened").onclick=function(){parentnode.opened=false;Element.hide(parentid+"_opened");Element.show(parentid+"_closed");Element.toggle(parentid+"_children")};parentnode._onopened=function(){parentnode.opened=true;Element.hide(parentid+"_closed");Element.show(parentid+"_opened");Element.show(parentid+"_children");closeChildren(parentid,null)};parentnode._onclosed=function(){parentnode.opened=false;Element.show(parentid+"_closed");Element.hide(parentid+"_opened");Element.hide(parentid+"_children");closeChildren(parentid,null)};parentnode.onclick=function(e){e=Event.getEvent(e);e.stop();if(!parentnode.opened){parentnode._onopened()}else{parentnode._onclosed()}}}})()}},getAttributes:function(){return[]},buildWidget:function(G,L){var H="";var K=0;var C=G.id;var B=[];if(Appcelerator.Browser.isIE){var J=G.innerHTML;J=J.replace(/<FOLDER/g,"<APP:FOLDER").replace(/\/FOLDER>/g,"/APP:FOLDER>");J=J.replace(/<ITEM/g,"<APP:ITEM").replace(/\/ITEM>/g,"/APP:ITEM>");G.innerHTML=J}for(var I=0;I<G.childNodes.length;I++){var E=G.childNodes[I];if(E.nodeType==1&&E.nodeName.toLowerCase()=="folder"){var A=E.getAttribute("opened_icon")||Appcelerator.Module.Folder.modulePath+"images/folder_opened.png";var M=E.getAttribute("closed_icon")||Appcelerator.Module.Folder.modulePath+"images/folder_closed.png";var F=C+"_folder_"+(K++);E._parentid=F;H+='<div id="'+F+'">';H+='<div class="folder" id="'+F+'_folder"><img class="folder_image" src="'+M+'" id="'+F+'_closed"/>';H+='<img class="folder_image" src="'+A+'" id="'+F+'_opened" style="display:none"/>';H+='<span class="folder_name" id="'+F+'_name">'+E.getAttribute("name")+"</span></div>";H+='<div class="folder_children" id="'+F+'_children" style="display:none">';var D=$A(E.childNodes).findAll(function(O){return O.nodeType==1&&O.nodeName.toLowerCase()=="item"});E._children=D;var N="";D.each(function(U,P){var O=U.getAttribute("opened_icon")||Appcelerator.Module.Folder.modulePath+"images/item_opened.png";var Q=U.getAttribute("closed_icon")||Appcelerator.Module.Folder.modulePath+"images/item_closed.png";var R=F+"_child_"+P;U._childid=R;H+='<div id="'+R+'">';H+='<div id="'+R+'_item" class="item"><img class="item_image" src="'+Q+'" id="'+R+'_closed"/>';H+='<img class="item_image" src="'+O+'" id="'+R+'_opened" style="display:none"/>';H+='<span class="item_name" id="'+R+'_name">'+Appcelerator.Compiler.getHtml(U,true)+"</span>";H+="</div></div>";var T=U.getAttribute("onopen");var S=U.getAttribute("onclose");if(T){T=Appcelerator.Compiler.makeAction(R,T)+";"}if(S){S=Appcelerator.Compiler.makeAction(R,S)+";"}B.push(R)});H+="</div></div>";K++}}L["nodes"]=G.childNodes;L["itemnodes"]=B;return{"position":Appcelerator.Compiler.POSITION_REPLACE,"presentation":H,"compile":true}}};Appcelerator.Core.registerModule("app:folder",Appcelerator.Module.Folder);Appcelerator.Core.loadModuleCSS("app:folder","folder.css")