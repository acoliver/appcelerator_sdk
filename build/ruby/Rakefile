require 'rubygems'
Gem::manage_gems

require 'rake/gempackagetask'

version="${ruby_gem_version}"
if !ENV['version'].nil?
  version = ENV['version']
end

spec = Gem::Specification.new do |s|
    s.platform  =   Gem::Platform::RUBY
    s.name      =   "appcelerator"
    s.version   =   version
    s.author    =   "Appcelerator.org"
    s.email     =   "support@appcelerator.org"
    s.summary   =   "Appcelerator on Rails. Appcelerator SDK is a web2.0, ajax web application framework by Appcelerator.org"
    s.homepage  =   "http://www.appcelerator.org"
    s.files     =   FileList['lib/*.rb','lib/appcelerator/**/*.rb','lib/appcelerator/parser/*.rb','lib/appcelerator/messagebroker/*.rb','lib/appcelerator/compiler/*.rb','service/*','service/templates/*','appcelerator/*.rb','appcelerator/templates/*','appcelerator/templates/css/*','appcelerator/templates/modules/**/*','appcelerator/templates/js/*','appcelerator/templates/images/*','bin/*'].to_a.delete_if {|f| f.include?('.svn')}
    s.require_path  =   "lib"
    s.default_executable = %q{appcelerator}
    s.executables = %w(appcelerator)
    s.add_dependency('rails', '>= 1.2.3')
    s.add_dependency('json', '>= 0.4.3')
    s.add_dependency('hpricot', '>= 0.5.0')
end

Rake::GemPackageTask.new(spec) do |pkg|
    pkg.need_tar = true
end

task :default => "pkg/#{spec.name}-#{spec.version}.gem" do
    puts "generated latest version"
end
