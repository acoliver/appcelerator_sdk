/*!(c) 2006-2008 Appcelerator, Inc. http://appcelerator.org
 * Licensed under the Apache License, Version 2.0. Please visit
 * http://license.appcelerator.com for full copy of the License.
 * Version: 3.0.0, Released: 10/24/2008
 **/
(function($){
/*
 ******************************************************************************
  uri_funcs.js - URI functions based on STD 66 / RFC 3986

  Author (original): Mike J. Brown <mike at skew.org>
  Version: 2007-01-04

  License: Unrestricted use and distribution with any modifications permitted,
  so long as:
  1. Modifications are attributed to their author(s);
  2. The original author remains credited;
  3. Additions derived from other code libraries are credited to their sources
  and used under the terms of their licenses.

*******************************************************************************/
var absoluteUriRefRegex=/^[A-Z][0-9A-Z+\-\.]*:/i;var splitUriRefRegex=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/;var reMissingGroupSupport=(typeof "".match(/(a)?/)[1]!="string");URI={};URI.isAbsolute=function(uriRef){return absoluteUriRefRegex.test(uriRef)};URI.splitUriRef=function(uriRef){var parts=uriRef.match(splitUriRefRegex);parts.shift();var scheme=parts[1],auth=parts[3],path=parts[4],query=parts[6],frag=parts[8];if(!reMissingGroupSupport){var undef;if(parts[0]==""){scheme=undef}if(parts[2]==""){auth=undef}if(parts[5]==""){query=undef}if(parts[7]==""){frag=undef}}parts=[scheme,auth,this.uriPathRemoveDotSegments(path),query,frag];return parts};URI.unsplitUriRef=function(uriRefSeq){var uriRef="";if(typeof uriRefSeq[0]!="undefined"){uriRef+=uriRefSeq[0]+":"}if(typeof uriRefSeq[1]!="undefined"){uriRef+="//"+uriRefSeq[1]}uriRef+=uriRefSeq[2];if(typeof uriRefSeq[3]!="undefined"){uriRef+="?"+uriRefSeq[3]}if(typeof uriRefSeq[4]!="undefined"){uriRef+="#"+uriRefSeq[4]}return uriRef};URI.uriPathRemoveDotSegments=function(path){if(path=="."||path==".."){return""}while(path){if(path.substring(0,2)=="./"){path=path.substring(2)}else{if(path.substring(0,3)=="../"){path=path.substring(3)}else{if(path.substring(0,2)=="//"){path=path.substring(1)}else{break}}}}var leading_slash=false;if(path.charAt(0)=="/"){path=path.substring(1);if(path.charAt(0)=="/"){path=path.substring(1)}leading_slash=true}if(path.substring(path.length-2)=="/."){path=path.substring(0,path.length-1)}var segments=path.split("/");var keepers=[];segments=segments.reverse();while(segments.length){var seg=segments.pop();if(seg==".."){if(keepers.length){keepers.pop()}else{if(!leading_slash){keepers.push(seg)}}if(!segments.length){keepers.push("")}}else{if(seg!="."){keepers.push(seg)}}}return(leading_slash&&"/"||"")+keepers.join("/")};URI.absolutizeURI=function(uriRef,baseUri){if(!baseUri||!URI.isAbsolute(baseUri)){throw Error("baseUri '"+baseUri+"' is not absolute")}if(uriRef==""||uriRef.charAt(0)=="#"){return baseUri.split("#")[0]+uriRef}var tScheme,tAuth,tPath,tQuery;var parts=URI.splitUriRef(uriRef);var rScheme=parts[0],rAuth=parts[1],rPath=parts[2],rQuery=parts[3],rFrag=parts[4];if(typeof rScheme!="undefined"){var tScheme=rScheme;var tAuth=rAuth;var tPath=URI.uriPathRemoveDotSegments(rPath);var tQuery=rQuery}else{parts=URI.splitUriRef(baseUri);var bScheme=parts[0],bAuth=parts[1],bPath=parts[2],bQuery=parts[3],bFrag=parts[4];if(typeof rAuth!="undefined"){tAuth=rAuth;tPath=URI.uriPathRemoveDotSegments(rPath);tQuery=rQuery}else{if(!rPath){tPath=bPath;tQuery=(typeof rQuery!="undefined"&&rQuery||bQuery)}else{if(rPath.charAt(0)=="/"){tPath=URI.uriPathRemoveDotSegments(rPath)}else{if(typeof bAuth!="undefined"&&!bPath){tPath="/"+rPath}else{tPath=bPath.substring(0,bPath.lastIndexOf("/")+1)+rPath}tPath=URI.uriPathRemoveDotSegments(tPath)}tQuery=rQuery}tAuth=bAuth}tScheme=bScheme}var result=URI.unsplitUriRef([tScheme,tAuth,tPath,tQuery,rFrag]);return result};App=AppC={};AppC.Version={value:"3.0.0",major:parseInt("3"),minor:parseInt("0"),revision:parseInt("0"),date:"10/24/2008",toString:function(){return this.value}};var started=new Date;var compileTime;var loadTime;AppC.LicenseType="Apache License Version 2.0 - see http://license.appcelerator.org";AppC.Copyright="Copyright (c) 2006-"+(1900+started.getYear())+" by Appcelerator, Inc. All Rights Reserved.";AppC.LicenseMessage="Appcelerator is licensed under "+AppC.LicenseType;var docRoot;var idx=top.window.document.location.href.lastIndexOf("/");if(idx==top.window.document.location.href.length-1){docRoot=top.window.document.location.href}else{docRoot=top.window.document.location.href.substr(0,idx);if(docRoot.substring(docRoot.length-1)!="/"){docRoot=docRoot+"/"}}AppC.config={track_stats:true,report_stats:true,browser_check:true,auto_locale:false};AppC.params={debug:0,delayCompile:false,};function queryString(uri,params){idx=uri.indexOf("?");params=params||{};if(idx>0){var qs=uri.substring(idx+1);$.each(qs.split("&"),function(){var e=this.split("=");var v=decodeURIComponent(e[1]||"");var k=decodeURIComponent(e[0]);switch(v){case"1":case"true":v=true;break;case"0":case"false":v=false;break}params[k]=v})}return params}queryString(top.window.document.location.href,AppC.params);AppC.docRoot=docRoot;var absRe=/file:|http(s)?:/;var jsLocation=$("script[@src~=appcelerator]").get(0).src;var baseLocation=$("base[@href]").attr("href");if(baseLocation){AppC.docRoot=baseLocation}if(!absRe.test(jsLocation)){jsLocation=AppC.docRoot+(jsLocation.charAt(0)=="/"?jsLocation.substring(1):jsLocation)}queryString(jsLocation,AppC.config);if(!baseLocation){var hostIdx=jsLocation.indexOf(":/");if(hostIdx>0){var jsHostPath=jsLocation.substring(hostIdx+3,jsLocation.indexOf("/",hostIdx+4));var docIdx=AppC.docRoot.indexOf(":/");if(docIdx>0){var docHostPath=AppC.docRoot.substring(docIdx+3,AppC.docRoot.indexOf("/",docIdx+4));if(docHostPath==jsHostPath){AppC.docRoot=URI.absolutizeURI(jsLocation.substring(0,jsLocation.lastIndexOf("/"))+"/../",AppC.docRoot)}}}else{if(jsLocation.charAt(0)=="/"||jsLocation.charAt(0)=="."){var idx=jsLocation.lastIndexOf("/");if(idx!=-1){AppC.docRoot=URI.absolutizeURI(jsLocation.substring(0,idx+1)+"../",AppC.docRoot)}}}}AppC.compRoot=AppC.docRoot+"components/";AppC.pluginRoot=AppC.compRoot+"plugins/";var appid=0;App.ensureId=function(el){var rootEl=el.nodeType?el:$(el).get(0);var id=rootEl.id;if(!id){rootEl.id=rootEl.nodeName=="BODY"?"app_body":"app_"+(appid++)}return el};$.fn.compile=function(){if(arguments.length==2&&typeof (arguments[0])=="object"){var state=arguments[1];$.each(arguments[0],function(){$(this).compile(state)})}else{if(arguments.length==1&&typeof (arguments[0].count)=="number"){var state=arguments[0];var node=$(this).get(0);var el=App.ensureId(node);var e=$(el);App.incState(state);var myid=e.attr("id");var compiled=App.runProcessors(el,state);$.debug(" + compiled #"+myid+" ("+getTagName(node)+") => "+compiled);if(compiled){App.checkState(state,el)}}}return this};$.fn.compileChildren=function(state,self){var node=$(this).get(0);App.ensureId(node);var set=getTargetCompileSet(node,self);this.compile(set,state);return this};var state=function(el){this.count=1;this.el=el;this.completed=[]};App.createState=function(el){return new state(el)};App.incState=function(state){if(state){var count=++state.count;return count}};var bodyCompiled=false;App.checkState=function(state,el){if(state){if(el){state.completed.push($(el).get(0))}var count=--state.count;if(count==0){$.each($.unique(state.completed),function(){if(this!=document.body){$(this).trigger("compiled")}});if(!bodyCompiled){bodyCompiled=true;$(document.body).trigger("compiled")}}}};function getTargetCompileSet(node,self){var expr=null,filter=null;if(node!=null){node=typeof (node.nodeType)=="undefined"?node.get(0):node;var parent=node.nodeName=="BODY"?"body":"#"+node.id;expr=(self?(parent+","):"")+parent+" "+App.selectors.join(", "+parent+" ")}else{expr=App.selectors.join(",");filter=function(){var exclude=App.delegateCompilers.join(",");return !$(this).parents(exclude).length}}if(filter){return $.unique($(expr).filter(filter))}return $.unique($(expr))}var beforeCompilers=[];AppC.beforeCompile=function(f){if(!beforeCompilers){f()}else{beforeCompilers.push(f)}return AppC};AppC.compileDocument=function(){var compileStarted=new Date;var body=$(document.body);if(beforeCompilers){$.each(beforeCompilers,function(){this(body)});beforeCompilers=null}body.bind("compiled",function(){body.pub("l:app.compiled",{event:{id:document.body.id||"body"}});$(document).trigger("compiled");compileFinished=new Date;loadTime=compileFinished-started;compileTime=compileFinished-compileStarted;if(top.window===window){$.info(AppC.Copyright);$.info(AppC.LicenseMessage);$.info("loaded in "+(loadTime)+" ms, compiler took ~"+(compileTime)+" ms");$.info("Appcelerator is ready!")}});var s=new state(body);$(document).compile(getTargetCompileSet(),s);App.checkState(s)};if(!AppC.params.delayCompile){$(document).ready(AppC.compileDocument)}var debug=AppC.params.debug&&AppC.params.debug=="1"||AppC.params.debug==true;var hasConsole=typeof (console)!="undefined";var keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";$.extend({domText:function(dom){var str="";for(var c=0;c<dom.childNodes.length;c++){str+=dom.childNodes[c].nodeValue||""}return $.trim(str)},gsub:function(source,pattern,replacement){if(typeof (replacement)=="string"){var r=String(replacement);replacement=function(){return r}}var result="",match;while(source.length>0){if(match=source.match(pattern)){result+=source.slice(0,match.index);result+=this.string(replacement(match));source=source.slice(match.index+match[0].length)}else{result+=source,source=""}}return result},camel:function(value){var parts=value.split("-"),len=parts.length;if(len==1){return parts[0]}var camelized=value.charAt(0)=="-"?parts[0].charAt(0).toUpperCase()+parts[0].substring(1):parts[0];for(var i=1;i<len;i++){camelized+=parts[i].charAt(0).toUpperCase()+parts[i].substring(1)}return camelized},string:function(value){return value==null?"":String(value)},proper:function(value){return value.charAt(0).toUpperCase()+value.substring(1)},smartSplit:function(value,splitter){if(typeof (value)!="string"){$.error("Invalid parameter passed to smartSplit: "+typeof (value)+", value: "+value)}value=this.trim(value);var tokens=value.split(splitter);if(tokens.length==1){return tokens}var array=[];var current=null;for(var c=0;c<tokens.length;c++){var line=tokens[c];if(!current&&line.charAt(0)=="("){current=line+" or ";continue}else{if(current&&current.charAt(0)=="("){if(line.indexOf(") ")!=-1){array.push(current+line);current=null}else{current+=line+" or "}continue}}if(!current&&line.indexOf("[")>=0&&line.indexOf("]")==-1){if(current){current+=splitter+line}else{current=line}}else{if(current&&line.indexOf("]")==-1){current+=splitter+line}else{if(current){array.push(current+splitter+line);current=null}else{array.push(line)}}}}return array},escapeXML:function(value){if(!value){return null}return value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},unescapeXML:function(value){if(!value){return null}return value.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&amp;/g,"&").replace(/&quot;/g,'"')},emptyFunction:function(){},toFunction:function(str,dontPreProcess){var str=$.trim(str);if(str.length==0){return this.emptyFunction}if(!dontPreProcess){if(str.match(/^function\(/)){str="return "+this.unescapeXML(str)+"()"}else{if(!str.match(/return/)){str="return "+this.unescapeXML(str)}else{if(str.match(/^return function/)){str=this.unescapeXML(str)+" ();"}}}}var code="var f = function(){ var args = $.makeArray(arguments); "+str+"}; f;";var func=eval(code);if(this.isFunction(func)){return func}throw Error("code was not a function: "+this)},getNestedProperty:function(obj,prop,def){if(obj!=null&&prop!=null){var props=prop.split(".");if(props.length!=-1){var cur=obj;this.each(props,function(){var p=this;if(null!=cur[p]){cur=cur[p]}else{cur=null;return false}});return cur==null?def:cur}else{return obj[prop]==null?def:obj[prop]}}return def},startsWith:function(a,b){return a.indexOf(b)===0},error:function(){var log=$.makeArray(arguments).join(" ");if(hasConsole){if($.isFunction(console.error)){console.error(log)}else{if($.isFunction(console.log)){console.log(log)}}}},info:function(){var log=$.makeArray(arguments).join(" ");if(hasConsole){if($.isFunction(console.info)){console.info(log)}else{if($.isFunction(console.log)){console.log(log)}}}},debug:function(){if(debug){var log=$.makeArray(arguments).join(" ");if(hasConsole){if($.isFunction(console.debug)){console.debug(log)}else{if($.isFunction(console.log)){console.log(log)}}}}},encode64:function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;do{chr1=input.charCodeAt(i++);chr2=input.charCodeAt(i++);chr3=input.charCodeAt(i++);enc1=chr1>>2;enc2=((chr1&3)<<4)|(chr2>>4);enc3=((chr2&15)<<2)|(chr3>>6);enc4=chr3&63;if(isNaN(chr2)){enc3=enc4=64}else{if(isNaN(chr3)){enc4=64}}output=output+keyStr.charAt(enc1)+keyStr.charAt(enc2)+keyStr.charAt(enc3)+keyStr.charAt(enc4)}while(i<input.length);return output},decode64:function(input){var output="";var chr1,chr2,chr3;var enc1,enc2,enc3,enc4;var i=0;input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{enc1=keyStr.indexOf(input.charAt(i++));enc2=keyStr.indexOf(input.charAt(i++));enc3=keyStr.indexOf(input.charAt(i++));enc4=keyStr.indexOf(input.charAt(i++));chr1=(enc1<<2)|(enc2>>4);chr2=((enc2&15)<<4)|(enc3>>2);chr3=((enc3&3)<<6)|enc4;output=output+String.fromCharCode(chr1);if(enc3!=64){output=output+String.fromCharCode(chr2)}if(enc4!=64){output=output+String.fromCharCode(chr3)}}while(i<input.length);return output},toQueryString:function(obj){var qs=[];for(var k in obj){var v=obj[k];var t=typeof (v);switch(t){case"number":case"string":case"boolean":qs.push(encodeURIComponent(k)+"="+encodeURIComponent(String(v)));break;case"object":qs.push(encodeURIComponent(k)+"="+encodeURIComponent($.toJSON(v)));break}}return qs.join("&")},loadCSS:function(url){var head=document.getElementsByTagName("head")[0];var link=document.createElement("link");link.rel="stylesheet";link.type="text/css";link.href=url;head.appendChild(link)}});$.Class={create:function(){var parent=null,properties=$.makeArray(arguments);if($.isFunction(properties[0])){parent=properties.shift()}function klass(){this.initialize.apply(this,arguments)}$.Class.extend(klass,$.Class.Methods);klass.superclass=parent;klass.subclasses=[];if(parent){var subclass=function(){};subclass.prototype=parent.prototype;klass.prototype=new subclass;parent.subclasses.push(klass)}for(var i=0;i<properties.length;i++){klass.addMethods(properties[i])}if(!klass.prototype.initialize){klass.prototype.initialize=$.emptyFunction}klass.prototype.constructor=klass;return klass}};$.Class.Methods={addMethods:function(source){var ancestor=this.superclass&&this.superclass.prototype;var properties=[];for(var key in source){properties.push(key)}for(var i=0,length=properties.length;i<length;i++){var property=properties[i],value=source[property];this.prototype[property]=value}return this}};$.Class.extend=function(destination,source){for(var property in source){destination[property]=source[property]}return destination};AppC.create=$.Class.create;AppC.extend=$.Class.extend;$.fn.delay=function(fn,delay){var scope=this;var f=typeof (fn)=="number"?delay:fn;var n=typeof (fn)=="function"?delay:fn;setTimeout(function(){f.call(scope)},(n||0.1)*1000);return this};$.fn.defer=function(fn,delay){$(this).delay(fn,0.001);return this};AppC.Types={};AppC.Types.enumeration=function(){var pattern="^("+$.makeArray(arguments).join(")|(")+")$";return{name:"Enumeration",values:$.makeArray(arguments),regex:RegExp(pattern)}};AppC.Types.openEnumeration=function(){var pattern="^("+$.makeArray(arguments).join(")|(")+")|(.*)$";return{name:"Enumeration",values:$.makeArray(arguments),regex:RegExp(pattern)}};AppC.Types.pattern=function(regex,name){name=name||"pattern";return{name:name,regex:regex}};AppC.Types.bool=AppC.Types.enumeration("true","false");AppC.Types.bool.name="Boolean";AppC.Types.number=AppC.Types.pattern(/^-?[0-9]+(\.[0-9]+)$/,"Number");AppC.Types.naturalNumber=AppC.Types.pattern(/[0-9]+/,"Natural Number");AppC.Types.cssDimension=AppC.Types.pattern(/^-?[0-9]+(\.[0-9]+)(%|(em)|(en)|(px)|(pc)|(pt))?$/,"CSS Dimension");AppC.Types.identifier=AppC.Types.pattern(/^[a-zA-Z_][a-zA-Z0-9_.]*$/,"Identifier");AppC.Types.messageSend=AppC.Types.pattern(/^((l:)|(r:)|(local:)|(remote:))[a-zA-Z0-9_.]+/,"AppC Message Send");AppC.Types.messageReceive=AppC.Types.pattern(/^((l:)|(r:)|(local:)|(remote:))((~.+)|([a-zA-Z0-9_.]+))/,"AppC Message Reception");AppC.Types.onExpr={name:"On Expression"};AppC.Types.fieldset={name:"Fieldset"};AppC.Types.json={name:"JSON Object"};AppC.Types.javascriptExpr={name:"Javascript Expression"};AppC.Types.pathOrUrl={name:"Path or url to resource"};AppC.Types.cssClass={name:"CSS Class name"};AppC.Types.color={name:"Color value"};AppC.Types.time={name:"Time value"};AppC.Types.elementId={name:"Element Id"};AppC.Types.commaSeparated={name:"Comma Separated Values"};AppC.Types.languageId={name:"Localization String Id"};AppC.Types.string={name:"Javascript String"};AppC.Types.object={name:"Javascript Object"};AppC.Types.condition={name:"Component Condition"};AppC.Types.action={name:"Component Action"};AppC.Types.isInstance=function(value,type){if(type.regex){return type.regex.test(value)}switch(type){case AppC.Types.onExpr:try{var thens=App.parseExpression(value);return thens&&thens.length>0}catch(e){return false}case AppC.Types.time:return value&&!isNaN(App.timeFormat(value));case AppC.Types.fieldset:return true;default:return true}};AppC.Types.getTypeId=function(type){throw new Error("this method is no longer supported")};App.selectors=[];App.delegateCompilers=[];var actions={};function addProcessor(tag,attr,handler,delegate,priority){var wildcard=tag=="*";tag=wildcard?tag.toLowerCase():tag;var found=actions[tag];if(!found){found=[];actions[tag]=found}var isExpr=attr.indexOf("=")>0;found[priority?"unshift":"push"]({tag:tag,wildcard:wildcard,attr:attr,expr:isExpr,fn:handler,delegate:delegate});var expr=tag+"["+(!isExpr?"@":"")+attr+"]";App.selectors[priority?"unshift":"push"](expr);if(delegate){App.delegateCompilers[priority?"unshift":"push"](expr)}}function getTagName(el){var element=$(el).get(0);if(AppC.UA.IE){if(element.scopeName&&element.tagUrn){return(element.scopeName+":"+element.nodeName).toLowerCase()}}return element.nodeName.toLowerCase()}function iterateProcessors(f,el,tag,state){if(f){var e=$(el);var delegateCompile=false;$.each(f,function(){if(this.wildcard||tag==this.tag){if(!this.expr){var v=e.attr(this.attr);if(v){var r=this.fn.apply(e,[v,state,tag]);if(typeof (r)=="undefined"){r=true}if(r&&this.delegate){delegateCompile=true}}}else{var r=this.fn.apply(e,[tag,state]);if(typeof (r)=="undefined"){r=true}if(r&&this.delegate){delegateCompile=true}}}if(delegateCompile){return false}});return delegateCompile}return false}function getTarget(params,t){if(!params){return t}if(params.target){return $(params.target)}var nt=params.id?$("#"+params.id):null;return nt&&nt.length>0?nt:t}function regCSSAction(name,key,value){App.regAction(evtRegex(name),function(params){if(typeof (key)=="function"){key.call(getTarget(params,this),params)}else{return getTarget(params,this).css(key,value||name)}})}App.runProcessors=function(el,state){var tag=getTagName(el);var r1=iterateProcessors(actions[tag],el,tag,state);var r2=iterateProcessors(actions["*"],el,tag,state);return !(r1||r2)};App.reg=function(name,el,handler,delegateCompile,priority){if(typeof (el)=="string"){el=$.makeArray(el)}$.each(el,function(){addProcessor(this,name,handler,delegateCompile,priority)})};var regp={conds:{},actions:{},ractions:[]};var dyn={conds:{},actions:{}};App.dynloadAction=function(name,fn){App.regAction(name,fn);$.each(dyn.actions[name],function(){App.invokeAction(this.scope,name,this.params)});try{delete dyn.actions[name]}catch(E){dyn.actions[name]=null}};var actionRE=/\^([\w]+)\(/;var actionUnparsers={};App.parseParams=function(name){var f=actionUnparsers[name];return typeof (f)=="undefined"};App.regAction=function(name,fn,dontparse){dontparse=typeof (dontparse)=="undefined"?false:(dontparse===true);$.debug("adding action "+name+", dontparse = "+dontparse);var m=actionRE.exec(String(name));if(m&&m.length>1||typeof (name)=="string"){var fnName=m.length>1?m[1]:name;if(dontparse){actionUnparsers[fnName]=1}var f=$.fn[fnName];if(typeof (f)!="function"){}if(f){var mapFnName="_"+fnName;$.fn[mapFnName]=f;$.fn[fnName]=function(){if(!f){return }var r=f.apply(this,arguments);this.trigger(fnName);return r||this}}}regp.ractions.push({re:name,fn:fn,dontparse:dontparse})};App.makeCustomAction=function(el,value){var p=App.extractParameters(value);var meta={action:p.name,actionParams:p.params,delay:0,ifCond:null};actions[meta.action]=meta;return meta};App.invokeAction=function(name,data,params){$.debug("invokeAction called with "+name);var scope=this;var found=false;$.each(regp.ractions,function(){if(this.re.test(name)){found=true;var newparams=params||{};if(data&&!this.dontparse){for(var x=0;x<data.length;x++){var entry=data[x];var key=entry.key,value=entry.value;if(entry.keyExpression){key=App.getEvaluatedValue(entry.key,null,params,entry.keyExpression)}else{if(entry.valueExpression){value=App.getEvaluatedValue(entry.value,null,params,entry.valueExpression)}else{if(entry.empty){value=App.getEvaluatedValue(entry.key,null,params)}else{key=App.getEvaluatedValue(entry.key);value=App.getEvaluatedValue(entry.value,null,params)}}}newparams[key]=value}}else{if(data&&this.donparse){newparams=params}}$.debug("invoking action: "+name+" with: "+$.toJSON(newparams)+", scope="+$(scope).attr("id"));this.fn.apply(scope,[newparams,name,data]);return false}});if(!found){var fn=typeof (name)=="function"?name:$(this)[name];if(fn){var newparams=params||{};if(data){for(var x=0;x<data.length;x++){var entry=data[x];var key=entry.key,value=entry.value;if(entry.keyExpression){key=App.getEvaluatedValue(entry.key,null,params,entry.keyExpression)}else{if(entry.valueExpression){value=App.getEvaluatedValue(entry.value,null,params,entry.valueExpression)}else{if(entry.empty){value=App.getEvaluatedValue(entry.key,null,params)}else{key=App.getEvaluatedValue(entry.key);value=App.getEvaluatedValue(entry.value,null,params)}}}newparams[key]=value}}$.debug("invoking action: "+name+" with: "+$.toJSON(newparams)+", scope="+$(scope).attr("id"));fn.apply(scope,[newparams,name,params])}else{$.error("couldn't find an action named: "+name+" for target: "+$(this).attr("id"))}}};App.triggerElseAction=function(scope,params,meta){App.triggerAction(scope,params,{action:meta.elseAction,actionParams:meta.elseActionParams,delay:0})};App.triggerAction=function(scope,params,meta){var data=meta.actionParams;var action=meta.action;if(meta.ifCond){var r=eval(meta.ifCond);if(r){if(typeof (r)=="boolean"){r=(r===true)}}if(!r){action=meta.elseAction;data=meta.elseActionParams}}if(action){if(meta.delay>0){$(scope).delay(function(){App.invokeAction.apply(scope,[action,data,params])},meta.delay/1000)}else{App.invokeAction.apply(scope,[action,data,params])}}};App.dynregAction=function(actions){$.each($.makeArray(actions),function(){var name=$.string(this);var path=AppC.pluginRoot+"/"+name+"_action.js";var found=regp.actions[path];if(found){return App.regAction(name,found)}App.regAction(evtRegex(name),function(params){var c=dyn.actions[name];var scope=getTarget(params,this);if(c){return c.push({scope:scope,params:params})}dyn.actions[name]=[{scope:scope,params:params}];$.debug("remote loading action = "+path);$.getScript(path)})})};function convertParams(params){if(arguments.length==2&&typeof (params)=="string"){var key=arguments[0];var value=arguments[1];params={key:value}}return params}var parameterSeparatorRE=/[\$=:><!]+/;var parameterRE=/(.*?)\[(.*)?\]/i;var expressionRE=/^expr\((.*?)\)$/;var numberRe=/^[-+]{0,1}[0-9]+$/;var floatRe=/^[0-9]*[\.][0-9]*[f]{0,1}$/;var booleanRe=/^(true|false)$/;var quotedRe=/^['"]{1}|['"]{1}$/;var jsonRe=/^\{(.*)?\}$/;var STATE_LOOKING_FOR_VARIABLE_BEGIN=0;var STATE_LOOKING_FOR_VARIABLE_END=1;var STATE_LOOKING_FOR_VARIABLE_VALUE_MARKER=2;var STATE_LOOKING_FOR_VALUE_BEGIN=3;var STATE_LOOKING_FOR_VALUE_END=4;var STATE_LOOKING_FOR_VALUE_AS_JSON_END=5;function dequote(value){if(value&&typeof value=="string"){if(value.charAt(0)=="'"||value.charAt(0)=='"'){value=value.substring(1)}if(value.charAt(value.length-1)=="'"||value.charAt(value.length-1)=='"'){value=value.substring(0,value.length-1)}}return value}function convertInt(value){if(value.charAt(0)=="0"){if(value.length==1){return 0}return convertInt(value.substring(1))}return parseInt(value)}function decodeParameterValue(token,wasquoted){var value=null;if(token!=null&&token.length>0&&!wasquoted){var match=jsonRe.exec(token);if(match){value=$.evalJSON(match[0])}if(!value){var quoted=quotedRe.test(token);if(quoted){value=dequote(token)}else{if(floatRe.test(token)){value=parseFloat(token)}else{if(numberRe.test(token)){value=convertInt(token)}else{if(booleanRe.test(token)){value=(token=="true")}else{value=token}}}}}}if(token=="null"||value=="null"){return null}return value==null?token:value}App.getTagname=function(element){if(!element){throw"element cannot be null"}if(element.jquery){element=$(element).get(0)}if(element.nodeType!=1){throw"node: "+element.nodeName+" is not an element, was nodeType: "+element.nodeType+", type="+(typeof element)}if(element._tagName){return element._tagName}if($.browser.msie){if(element.scopeName&&element.tagUrn){return element.scopeName+":"+element.nodeName.toLowerCase()}}return String(element.nodeName.toLowerCase())};function formatValue(value,quote){quote=(quote==null)?true:quote;if(value!=null){var type=typeof (value);if(type=="boolean"||type=="array"||type=="object"){return value}if(value=="true"||value=="false"){return value=="true"}if(value.charAt(0)=="'"&&quote){return value}if(value.charAt(0)=='"'){value=value.substring(1,value.length-1)}if(quote){return"'"+value+"'"}return value}return""}function getInputFieldValue(elem,dequote,local){elem=$(elem);var tagname=App.getTagname(elem);if(tagname!="input"&&tagname!="textarea"&&tagname!="select"){return null}local=local==null?true:local;dequote=(dequote==null)?false:dequote;var type=elem.attr("type")||"text";var v=elem.val();switch(type){case"checkbox":return(v=="on"||v=="checked")}return formatValue(v,!dequote)}function getElementValue(element,dequote,local){var el=typeof (element)=="string"?$("#"+element):$(element);dequote=(dequote==null)?true:dequote;var elem=el.get(0);if(el.is(":input")){return el.val()}else{if(el.is("form")){var obj={};$.each(el.find(":input").filter(function(){return !this.disabled&&(this.checked||/select|textarea/i.test(this.nodeName)||/text|hidden|password/i.test(this.type))}).map(function(i,elem){var val=$(this).val();return val==null?null:val.constructor==Array?$.map(val,function(val,i){return{name:elem.name||elem.id,value:val}}):{name:elem.name||elem.id,value:val}}).get(),function(){obj[this.name]=this.value});return obj}else{if(el.is("img,iframe")){return elem.src}}}if(elem.value!=undefined){return elem.value}return elem.html()}App.getEvaluatedValue=function(v,data,scope,isExpression){if(v&&typeof (v)=="string"){if(!isExpression&&v.charAt(0)=="$"){var varName=v.substring(1);var elem=$("#"+varName);if(elem){return getElementValue(elem,true)}}else{if(!isExpression&&!isNaN(parseFloat(v))){return v}else{var match=isExpression||expressionRE.exec(v);if(match){var expr=isExpression?v:match[1];var func=$.toFunction(expr);var s=scope?scope:{};if(data){for(var k in data){if(typeof (k)=="string"){s[k]=data[k]}}}return func.call(s)}if(scope){var result=$.getNestedProperty(scope,v,null);if(result){return result}}if(data){return $.getNestedProperty(data,v,v)}}}}return v};App.extractParameters=function(value,scope){var idx=value.indexOf("[");if(idx!=-1){var endidx=value.lastIndexOf("]");var p=value.substring(idx+1,endidx);var action=value.substring(0,idx);var canParse=App.parseParams(action);var params=null;if(canParse){params=App.getParameters(p,false);if(params&&scope){var newparams={};for(var x=0;x<params.length;x++){var entry=params[x];var key=entry.key,value=entry.value;if(entry.keyExpression){key=App.getEvaluatedValue(entry.key,null,scope,entry.keyExpression)}else{if(entry.valueExpression){value=App.getEvaluatedValue(entry.value,null,scope,entry.valueExpression)}else{if(entry.empty){value=App.getEvaluatedValue(entry.key,null,scope)}else{key=App.getEvaluatedValue(entry.key);value=App.getEvaluatedValue(entry.value,null,scope)}}}newparams[key]=value}params=newparams}}return{name:action,params:params||p}}return{name:value,params:null}};App.getParameters=function(str,asjson){if(str==null||str.length==0){return asjson?{}:[]}var exprRE=/expr\((.*?)\)/;var containsExpr=exprRE.test(str);if(!parameterSeparatorRE.test(str)&&!containsExpr){if(asjson){var valueless_key={};valueless_key[str]="";return valueless_key}else{return[{key:str,value:"",empty:true}]}}var state=0;var currentstr="";var key=null;var data=asjson?{}:[];var quotedStart=false,tickStart=false;var operator=null;var expressions=containsExpr?{}:null;if(containsExpr){var expressionExtractor=function(e){var start=e.indexOf("expr(");if(start<0){return null}var p=start+5;var end=e.length-1;var value="";while(true){var idx=e.indexOf(")",p);if(idx<0){break}value+=e.substring(p,idx);if(idx==e.length-1){end=idx+1;break}var b=false;var x=idx+1;for(;x<e.length;x++){switch(e.charAt(x)){case",":end=x;b=true;break;case" ":break;default:p=idx+1;break}}if(x==e.length-1){end=x;break}if(b){break}value+=")"}var fullexpr=e.substring(start,end);return[fullexpr,value]};var ec=0;while(true){var m=expressionExtractor(str);if(!m){break}var k="__E__"+(ec++);expressions[k]=m[1];str=str.replace(m[0],k)}}function transformValue(k,v,tick){if(k&&$.startsWith(k,"__E__")){if(!asjson){return{key:expressions[k],value:v,keyExpression:true,valueExpression:false}}else{return eval(expressions[k])}}if(v&&$.startsWith(v,"__E__")){if(!asjson){return{key:k,value:expressions[v],valueExpression:true,keyExpression:false}}else{return eval(expressions[v])}}var s=decodeParameterValue(v,tick);if(!asjson){return{key:k,value:s}}return s}for(var c=0,len=str.length;c<len;c++){var ch=str.charAt(c);var append=true;switch(ch){case'"':case"'":switch(state){case STATE_LOOKING_FOR_VARIABLE_BEGIN:quoted=true;append=false;state=STATE_LOOKING_FOR_VARIABLE_END;quotedStart=ch=='"';tickStart=ch=="'";break;case STATE_LOOKING_FOR_VARIABLE_END:var previous=str.charAt(c-1);if(quotedStart&&ch=="'"||tickStart&&ch=='"'){}else{if(previous!="\\"){state=STATE_LOOKING_FOR_VARIABLE_VALUE_MARKER;append=false;key=$.trim(currentstr);currentstr=""}}break;case STATE_LOOKING_FOR_VALUE_BEGIN:append=false;quotedStart=ch=='"';tickStart=ch=="'";state=STATE_LOOKING_FOR_VALUE_END;break;case STATE_LOOKING_FOR_VALUE_END:var previous=str.charAt(c-1);if(quotedStart&&ch=="'"||tickStart&&ch=='"'){}else{if(previous!="\\"){state=STATE_LOOKING_FOR_VARIABLE_BEGIN;append=false;if(asjson){data[key]=transformValue(key,currentstr,quotedStart||tickStart)}else{data.push(transformValue(key,currentstr,quotedStart||tickStart))}key=null;quotedStart=false,tickStart=false;currentstr=""}}break}break;case">":case"<":case"=":case":":if(state==STATE_LOOKING_FOR_VARIABLE_END){if(ch=="<"||ch==">"){key=$.trim(currentstr);currentstr="";state=STATE_LOOKING_FOR_VARIABLE_VALUE_MARKER}}switch(state){case STATE_LOOKING_FOR_VARIABLE_END:append=false;state=STATE_LOOKING_FOR_VALUE_BEGIN;key=$.trim(currentstr);currentstr="";operator=ch;break;case STATE_LOOKING_FOR_VARIABLE_VALUE_MARKER:append=false;state=STATE_LOOKING_FOR_VALUE_BEGIN;operator=ch;break}break;case",":switch(state){case STATE_LOOKING_FOR_VARIABLE_BEGIN:append=false;state=STATE_LOOKING_FOR_VARIABLE_BEGIN;break;case STATE_LOOKING_FOR_VARIABLE_END:state=STATE_LOOKING_FOR_VARIABLE_BEGIN;append=false;if(asjson){data[currentstr]=null}else{var entry=transformValue(key,currentstr);entry.operator=operator;entry.key=entry.value;entry.empty=true;data.push(entry)}key=null;quotedStart=false,tickStart=false;currentstr="";break;case STATE_LOOKING_FOR_VALUE_END:if(!quotedStart&&!tickStart){state=STATE_LOOKING_FOR_VARIABLE_BEGIN;append=false;if(asjson){data[key]=transformValue(key,currentstr,quotedStart||tickStart)}else{var entry=transformValue(key,currentstr);entry.operator=operator;data.push(entry)}key=null;quotedStart=false,tickStart=false;currentstr=""}break}break;case" ":break;case"\n":case"\t":case"\r":append=false;break;case"{":switch(state){case STATE_LOOKING_FOR_VALUE_BEGIN:state=STATE_LOOKING_FOR_VALUE_AS_JSON_END}break;case"}":if(state==STATE_LOOKING_FOR_VALUE_AS_JSON_END){state=STATE_LOOKING_FOR_VARIABLE_BEGIN;append=false;currentstr+="}";if(asjson){data[key]=transformValue(key,currentstr,quotedStart||tickStart)}else{var entry=transformValue(key,currentstr);entry.operator=operator;data.push(entry)}key=null;quotedStart=false,tickStart=false;currentstr=""}break;default:switch(state){case STATE_LOOKING_FOR_VARIABLE_BEGIN:state=STATE_LOOKING_FOR_VARIABLE_END;break;case STATE_LOOKING_FOR_VALUE_BEGIN:state=STATE_LOOKING_FOR_VALUE_END;break}}if(append){currentstr+=ch}if(c+1==len&&key){currentstr=$.trim(currentstr);if(asjson){data[key]=transformValue(key,currentstr,quotedStart||tickStart)}else{var entry=transformValue(key,currentstr);entry.operator=operator;data.push(entry)}}}if(currentstr&&!key){if(asjson){data[key]=null}else{var entry=transformValue(key,currentstr);entry.empty=true;entry.key=entry.value;entry.operator=operator;data.push(entry)}}return data};function isIDRef(value){if(value){if(typeof (value)=="string"){return value.charAt(0)=="$"}}return false}App.parseConditionCondition=function(actionParams,data){var ok=true;if(actionParams){for(var c=0,len=actionParams.length;c<len;c++){var p=actionParams[c];var negate=false,regex=false;if(p.empty&&p.value){p.key=p.value;p.keyExpression=p.valueExpression;p.value=null}var lhs=p.key,rhs=p.value,operator=p.operator||"";if(p.key&&p.key.charAt(0)=="!"){negate=true;lhs=p.key.substring(1)}else{if(p.key&&p.key.charAt(p.key.length-1)=="!"){negate=true;lhs=p.key.substring(0,p.key.length-1)}}var preLHS=lhs;if(p.keyExpression||isIDRef(lhs)){var out=App.getEvaluatedValue(lhs,data,data,p.keyExpression);if(!p.keyExpression&&isIDRef(lhs)&&lhs==out){lhs=null}else{lhs=out}}else{lhs=App.getEvaluatedValue(lhs,data)}if(lhs==preLHS){lhs=null}if((operator=="<"||operator==">")&&(rhs&&typeof (rhs)=="string"&&rhs.charAt(0)=="=")){operator+="=";rhs=rhs.substring(1)}if(rhs&&typeof (rhs)=="string"&&rhs.charAt(0)=="~"){regex=true;rhs=rhs.substring(1)}if(p.empty){rhs=lhs}else{if(p.keyExpression||isIDRef(rhs)){var out=App.getEvaluatedValue(rhs,data,data,p.valueExpression);if(!p.valueExpression&&isIDRef(rhs)&&rhs==out){rhs=null}else{rhs=out}}else{rhs=App.getEvaluatedValue(rhs,data)}}if(regex){var r=new RegExp(rhs);ok=r.test(lhs)}else{if(!operator&&p.empty&&rhs==null){ok=lhs}else{switch(operator||"="){case"<":ok=parseInt(lhs)<parseInt(rhs);break;case">":ok=parseInt(lhs)>parseInt(rhs);break;case"<=":ok=parseInt(lhs)<=parseInt(rhs);break;case">=":ok=parseInt(lhs)>=parseInt(rhs);break;default:ok=String(lhs)==String(rhs);break}}}if(negate){ok=!ok}if(!ok){break}}}return ok};App.getJsonTemplateVar=function(namespace,var_expr,template_var){var def={};var o=$.getNestedProperty(namespace,var_expr,def);if(o==def){try{with(namespace){o=eval(var_expr)}}catch(e){return template_var}}if(typeof (o)=="object"){o=$.toJSON(o).replace(/"/g,"&quot;")}return o};var templateRE=/#\{(.*?)\}/g;AppC.compileTemplate=function(html,htmlonly,varname,re){html=html||"";varname=varname==null?"f":varname;re=re||templateRE;var fn=function(m,name,format,args){return"', jtv(values,'"+name+"','#{"+name+"}'),'"};var body="var "+varname+" = function(values){ var jtv = App.getJsonTemplateVar; return ['"+html.replace(/(\r\n|\n)/g,"").replace(/\t/g," ").replace(/'/g,"\\'").replace(re,fn)+"'].join('');};"+(htmlonly?"":varname);var result=htmlonly?body:eval(body);return result};App.componentData={};App.getData=function(id,key){var d=App.componentData[id];if(!d){return null}if(!key){return d}return d[key]};App.setData=function(id,data){var d=App.componentData[id];if(!d){App.componentData[id]=data}else{for(var p in data){d[p]=data[p]}}};var conds=[];App.regCond=function(re,fn){conds.push({re:re,fn:fn})};App.processCond=function(el,info){var f=false;$.each(conds,function(){if(this.re.test(info.cond)){f=true;this.fn.call(el,info);return false}});if(!f){$.error("not match for cond = "+info.cond+" for element with id: "+$(el).attr("id"))}};function smartTokenSearch(searchString,value){var validx=-1;if(searchString.indexOf("[")>-1&&searchString.indexOf("]")>-1){var possibleValuePosition=searchString.indexOf(value);if(possibleValuePosition>-1){var in_left_bracket=false;for(var i=possibleValuePosition;i>-1;i--){if(searchString.charAt(i)=="]"){break}if(searchString.charAt(i)=="["){in_left_bracket=true;break}}var in_right_bracket=false;for(var i=possibleValuePosition;i<searchString.length;i++){if(searchString.charAt(i)=="["){break}if(searchString.charAt(i)=="]"){in_right_bracket=true;break}}if(in_left_bracket&&in_right_bracket){validx=-1}else{validx=searchString.indexOf(value)}}else{validx=possibleValuePosition}}else{validx=searchString.indexOf(value)}return validx}var compoundCondRE=/^\((.*)?\) then$/;App.parseExpression=function(value,element){if(!value){return[]}if(typeof (value)!="string"){alert("framework error: value was "+value+" -- unexpected type: "+typeof (value));throw"value: "+value+" is not a string!"}value=$.gsub(value,"\n"," ");value=$.gsub(value,"\r"," ");value=$.gsub(value,"\t"," ");value=$.trim(value);var thens=[];var ors=$.smartSplit(value," or ");for(var c=0,len=ors.length;c<len;c++){var expression=$.trim(ors[c]);var thenidx=expression.indexOf(" then ");if(thenidx<=0){throw"syntax error: expected 'then' for expression: "+expression}var condition=expression.substring(0,thenidx);var testExpr=expression.substring(0,thenidx+5);var condMatch=compoundCondRE.exec(testExpr);if(condMatch){var expressions=condMatch[1];condition=$.smartSplit(expressions," or ")}var elseAction=null;var nextstr=expression.substring(thenidx+6);var elseidx=smartTokenSearch(nextstr,"else");var increment=5;if(elseidx==-1){elseidx=nextstr.indexOf("otherwise");increment=10}var action=null;if(elseidx>0){action=nextstr.substring(0,elseidx-1);elseAction=nextstr.substring(elseidx+increment)}else{action=nextstr}var nextStr=elseAction||action;var ifCond=null;var ifIdx=nextStr.indexOf(" if expr[");if(ifIdx!=-1){var ifStr=nextStr.substring(ifIdx+9);var endP=ifStr.indexOf("]");if(endP==-1){throw"error in if expression, missing end parenthesis at: "+action}ifCond=ifStr.substring(0,endP);if(elseAction){elseAction=nextStr.substring(0,ifIdx)}else{action=nextStr.substring(0,ifIdx)}nextStr=ifStr.substring(endP+2)}var delay=0;var afterIdx=smartTokenSearch(nextstr,"after ");if(afterIdx!=-1){var afterStr=nextstr.substring(afterIdx+6);delay=App.timeFormat(afterStr);if(!ifCond){if(elseAction){elseAction=nextStr.substring(0,afterIdx-1)}else{action=nextStr.substring(0,afterIdx-1)}}}thens.push([null,condition,action,elseAction,delay,ifCond])}return thens};var ONE_SECOND=1000;var ONE_MINUTE=60000;var ONE_HOUR=3600000;var ONE_DAY=86400000;var ONE_WEEK=604800000;var ONE_MONTH=18748800000;var ONE_YEAR=31536000000;App.timeFormat=function(value){if(typeof (value)=="number"){return value}var str="";var time=0;for(var c=0,len=value.length;c<len;c++){var ch=value.charAt(c);switch(ch){case",":case" ":str="";break;case"m":if(c+1<len){var nextch=value.charAt(c+1);if(nextch=="s"){time+=parseInt(str);c++}}else{time+=parseInt(str)*ONE_MINUTE}str="";break;case"s":time+=parseInt(str)*ONE_SECOND;str="";break;case"h":time+=parseInt(str)*ONE_HOUR;str="";break;case"d":time+=parseInt(str)*ONE_DAY;str="";break;case"w":time+=parseInt(str)*ONE_WEEK;str="";break;case"y":time+=parseInt(str)*ONE_YEAR;str="";break;default:str+=ch;break}}if(str.length>0){time+=parseInt(str)}return time};var events=["blur","click","change","dblclick","focus","keydown","keyup","keypress","mousedown","mousemove","mouseout","mouseover","mouseup","resize","scroll","select","submit"];function evtRegex(name){return new RegExp("^"+name+"(\\[(.*)?\\])?$")}App.regCond(new RegExp("^("+events.join("|")+")[!]?$"),function(meta){var stop=false;var cond=meta.cond;if(cond.charAt(cond.length-1)=="!"){cond=cond.substring(0,cond.length-1);stop=true}var fn=function(e){var scope=$(this);var data=App.getFieldsetData(scope);data.event={id:$(this).attr("id"),x:e.pageX,y:e.pageY};$.debug("sending "+cond+", data = "+$.toJSON(data));App.triggerAction(scope,data,meta);if(stop){e.stopPropagation();return false}};this.bind(cond,fn);this.trash(function(){this.unbind(cond,fn)})});App.regCond(/^compiled$/,function(meta){var fn=function(){var scope=$(this);var data={event:{id:$(this).attr("id")}};App.triggerAction(scope,data,meta)};this.bind("compiled",fn);this.trash(function(){this.unbind("compiled",fn)})});
/*
 * Cookie plugin
 *
 * Copyright (c) 2006 Klaus Hartl (stilbuero.de)
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */
$.cookie=function(name,value,options){if(typeof value!="undefined"){options=options||{};if(value===null){value="";options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000))}else{date=options.expires}expires="; expires="+date.toUTCString()}var path=options.path?"; path="+(options.path):"";var domain=options.domain?"; domain="+(options.domain):"";var secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")}else{var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+"=")){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}};$.fn.cookie=$.cookie;App.reg("srcexpr","img",function(params){var value=null;for(var p in params){switch(p){case"id":case"event":break;default:value=params[p];break}}getTarget(params,this).srcexpr(value)});
/* some of this code came from Prototype and has been adapted to jQuery
*  Prototype is (c) 2005-2007 Sam Stephenson
*  Prototype is freely distributable under the terms of an MIT-style license.
*  For details, see the Prototype web site: http://www.prototypejs.org/
*--------------------------------------------------------------------------*/
Date.prototype.toJSON=function(){return'"'+this.getUTCFullYear()+"-"+(this.getUTCMonth()+1).toPaddedString(2)+"-"+this.getUTCDate().toPaddedString(2)+"T"+this.getUTCHours().toPaddedString(2)+":"+this.getUTCMinutes().toPaddedString(2)+":"+this.getUTCSeconds().toPaddedString(2)+'Z"'};String.specialChar={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\\":"\\\\"};$.times=function(ch,len){var str="";for(var c=0;c<len;c++){str+=ch}return str};Number.prototype.toPaddedString=function(length,radix){var string=this.toString(radix||10);return $.times("0",length-string.length)+string};String.prototype.toJSON=function(){var useDoubleQuotes=true;var escapedString=$.gsub(this,/[\x00-\x1f\\]/,function(match){var character=String.specialChar[match[0]];return character?character:"\\u00"+match[0].charCodeAt().toPaddedString(2,16)});if(useDoubleQuotes){return'"'+escapedString.replace(/"/g,'\\"')+'"'}return"'"+escapedString.replace(/'/g,"\\'")+"'"};Array.prototype.toJSON=function(){var results=[];$.each(this,function(object){var value=$.toJSON(this);if(value!==undefined){results.push(value)}});return"["+results.join(", ")+"]"};Number.prototype.toJSON=function(){return isFinite(this)?this.toString():"null"};Boolean.prototype.toJSON=function(){return String(this)};$.extend({toJSON:function(object){var type=typeof object;switch(type){case"undefined":case"function":case"unknown":return"null"}if(object===null){return"null"}if(typeof (object.jquery)=="string"){return null}if(object.toJSON){return object.toJSON()}if(object.nodeType==1){return }var results=[];for(var property in object){var value=object[property];if(value!==undefined){results.push($.toJSON(property)+": "+$.toJSON(value))}}return"{"+results.join(", ")+"}"},JSONFilter:/^\/\*-secure-([\s\S]*)\*\/\s*$/,unfilterJSON:function(str,filter){var m=(filter||this.JSONFilter).exec(str);return m?m[1]:str},isJSON:function(s){var str=s.replace(/\\./g,"@").replace(/"[^"\\\n\r]*"/g,"");return(/^[,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]*$/).test(str)},evalJSON:function(str,sanitize){var json=this.unfilterJSON(str);try{if(!sanitize||$.isJSON(json)){return eval("("+json+")")}}catch(e){}throw new SyntaxError("Badly formed JSON string: "+str)}});App.MD5={hexcase:0,b64pad:"",chrsz:8,hex_md5:function(s){return this.binl2hex(this.core_md5(this.str2binl(s),s.length*this.chrsz))},b64_md5:function(s){return this.binl2b64(this.core_md5(this.str2binl(s),s.length*this.chrsz))},str_md5:function(s){return this.binl2str(this.core_md5(this.str2binl(s),s.length*this.chrsz))},hex_hmac_md5:function(key,data){return this.binl2hex(this.core_hmac_md5(key,data))},b64_hmac_md5:function(key,data){return this.binl2b64(this.core_hmac_md5(key,data))},str_hmac_md5:function(key,data){return this.binl2str(this.core_hmac_md5(key,data))},md5_vm_test:function(){return this.hex_md5("abc")=="900150983cd24fb0d6963f7d28e17f72"},core_md5:function(x,len){x[len>>5]|=128<<((len)%32);x[(((len+64)>>>9)<<4)+14]=len;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(var i=0;i<x.length;i+=16){var olda=a;var oldb=b;var oldc=c;var oldd=d;a=this.md5_ff(a,b,c,d,x[i+0],7,-680876936);d=this.md5_ff(d,a,b,c,x[i+1],12,-389564586);c=this.md5_ff(c,d,a,b,x[i+2],17,606105819);b=this.md5_ff(b,c,d,a,x[i+3],22,-1044525330);a=this.md5_ff(a,b,c,d,x[i+4],7,-176418897);d=this.md5_ff(d,a,b,c,x[i+5],12,1200080426);c=this.md5_ff(c,d,a,b,x[i+6],17,-1473231341);b=this.md5_ff(b,c,d,a,x[i+7],22,-45705983);a=this.md5_ff(a,b,c,d,x[i+8],7,1770035416);d=this.md5_ff(d,a,b,c,x[i+9],12,-1958414417);c=this.md5_ff(c,d,a,b,x[i+10],17,-42063);b=this.md5_ff(b,c,d,a,x[i+11],22,-1990404162);a=this.md5_ff(a,b,c,d,x[i+12],7,1804603682);d=this.md5_ff(d,a,b,c,x[i+13],12,-40341101);c=this.md5_ff(c,d,a,b,x[i+14],17,-1502002290);b=this.md5_ff(b,c,d,a,x[i+15],22,1236535329);a=this.md5_gg(a,b,c,d,x[i+1],5,-165796510);d=this.md5_gg(d,a,b,c,x[i+6],9,-1069501632);c=this.md5_gg(c,d,a,b,x[i+11],14,643717713);b=this.md5_gg(b,c,d,a,x[i+0],20,-373897302);a=this.md5_gg(a,b,c,d,x[i+5],5,-701558691);d=this.md5_gg(d,a,b,c,x[i+10],9,38016083);c=this.md5_gg(c,d,a,b,x[i+15],14,-660478335);b=this.md5_gg(b,c,d,a,x[i+4],20,-405537848);a=this.md5_gg(a,b,c,d,x[i+9],5,568446438);d=this.md5_gg(d,a,b,c,x[i+14],9,-1019803690);c=this.md5_gg(c,d,a,b,x[i+3],14,-187363961);b=this.md5_gg(b,c,d,a,x[i+8],20,1163531501);a=this.md5_gg(a,b,c,d,x[i+13],5,-1444681467);d=this.md5_gg(d,a,b,c,x[i+2],9,-51403784);c=this.md5_gg(c,d,a,b,x[i+7],14,1735328473);b=this.md5_gg(b,c,d,a,x[i+12],20,-1926607734);a=this.md5_hh(a,b,c,d,x[i+5],4,-378558);d=this.md5_hh(d,a,b,c,x[i+8],11,-2022574463);c=this.md5_hh(c,d,a,b,x[i+11],16,1839030562);b=this.md5_hh(b,c,d,a,x[i+14],23,-35309556);a=this.md5_hh(a,b,c,d,x[i+1],4,-1530992060);d=this.md5_hh(d,a,b,c,x[i+4],11,1272893353);c=this.md5_hh(c,d,a,b,x[i+7],16,-155497632);b=this.md5_hh(b,c,d,a,x[i+10],23,-1094730640);a=this.md5_hh(a,b,c,d,x[i+13],4,681279174);d=this.md5_hh(d,a,b,c,x[i+0],11,-358537222);c=this.md5_hh(c,d,a,b,x[i+3],16,-722521979);b=this.md5_hh(b,c,d,a,x[i+6],23,76029189);a=this.md5_hh(a,b,c,d,x[i+9],4,-640364487);d=this.md5_hh(d,a,b,c,x[i+12],11,-421815835);c=this.md5_hh(c,d,a,b,x[i+15],16,530742520);b=this.md5_hh(b,c,d,a,x[i+2],23,-995338651);a=this.md5_ii(a,b,c,d,x[i+0],6,-198630844);d=this.md5_ii(d,a,b,c,x[i+7],10,1126891415);c=this.md5_ii(c,d,a,b,x[i+14],15,-1416354905);b=this.md5_ii(b,c,d,a,x[i+5],21,-57434055);a=this.md5_ii(a,b,c,d,x[i+12],6,1700485571);d=this.md5_ii(d,a,b,c,x[i+3],10,-1894986606);c=this.md5_ii(c,d,a,b,x[i+10],15,-1051523);b=this.md5_ii(b,c,d,a,x[i+1],21,-2054922799);a=this.md5_ii(a,b,c,d,x[i+8],6,1873313359);d=this.md5_ii(d,a,b,c,x[i+15],10,-30611744);c=this.md5_ii(c,d,a,b,x[i+6],15,-1560198380);b=this.md5_ii(b,c,d,a,x[i+13],21,1309151649);a=this.md5_ii(a,b,c,d,x[i+4],6,-145523070);d=this.md5_ii(d,a,b,c,x[i+11],10,-1120210379);c=this.md5_ii(c,d,a,b,x[i+2],15,718787259);b=this.md5_ii(b,c,d,a,x[i+9],21,-343485551);a=this.safe_add(a,olda);b=this.safe_add(b,oldb);c=this.safe_add(c,oldc);d=this.safe_add(d,oldd)}return Array(a,b,c,d)},md5_cmn:function(q,a,b,x,s,t){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(a,q),this.safe_add(x,t)),s),b)},md5_ff:function(a,b,c,d,x,s,t){return this.md5_cmn((b&c)|((~b)&d),a,b,x,s,t)},md5_gg:function(a,b,c,d,x,s,t){return this.md5_cmn((b&d)|(c&(~d)),a,b,x,s,t)},md5_hh:function(a,b,c,d,x,s,t){return this.md5_cmn(b^c^d,a,b,x,s,t)},md5_ii:function(a,b,c,d,x,s,t){return this.md5_cmn(c^(b|(~d)),a,b,x,s,t)},core_hmac_md5:function(key,data){var bkey=this.str2binl(key);if(bkey.length>16){bkey=this.core_md5(bkey,key.length*this.chrsz)}var ipad=Array(16),opad=Array(16);for(var i=0;i<16;i++){ipad[i]=bkey[i]^909522486;opad[i]=bkey[i]^1549556828}var hash=this.core_md5(ipad.concat(this.str2binl(data)),512+data.length*this.chrsz);return this.core_md5(opad.concat(hash),512+128)},safe_add:function(x,y){var lsw=(x&65535)+(y&65535);var msw=(x>>16)+(y>>16)+(lsw>>16);return(msw<<16)|(lsw&65535)},bit_rol:function(num,cnt){return(num<<cnt)|(num>>>(32-cnt))},str2binl:function(str){var bin=Array();var mask=(1<<this.chrsz)-1;for(var i=0;i<str.length*this.chrsz;i+=this.chrsz){bin[i>>5]|=(str.charCodeAt(i/this.chrsz)&mask)<<(i%32)}return bin},binl2str:function(bin){var str="";var mask=(1<<this.chrsz)-1;for(var i=0;i<bin.length*32;i+=this.chrsz){str+=String.fromCharCode((bin[i>>5]>>>(i%32))&mask)}return str},binl2hex:function(binarray){var hex_tab=this.hexcase?"0123456789ABCDEF":"0123456789abcdef";var str="";for(var i=0;i<binarray.length*4;i++){str+=hex_tab.charAt((binarray[i>>2]>>((i%4)*8+4))&15)+hex_tab.charAt((binarray[i>>2]>>((i%4)*8))&15)}return str},binl2b64:function(binarray){var tab="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var str="";for(var i=0;i<binarray.length*4;i+=3){var triplet=(((binarray[i>>2]>>8*(i%4))&255)<<16)|(((binarray[i+1>>2]>>8*((i+1)%4))&255)<<8)|((binarray[i+2>>2]>>8*((i+2)%4))&255);for(var j=0;j<4;j++){if(i*8+j*6>binarray.length*32){str+=this.b64pad}else{str+=tab.charAt((triplet>>6*(3-j))&63)}}}return str}};var loadedPlugins={};var dynamicPlugins={example:null};function installDynPlugin(name,fn){var l=loadedPlugins[name];if(l){return fn()}var path=AppC.pluginRoot+name+".js";$.getScript(path,function(){loadedPlugins[name]=1;fn()})}for(var name in dynamicPlugins){(function(){var found=$.fn[name];if(typeof (found)=="function"){return }$.fn[name]=function(){var arguments=arguments;var scope=this;var depends=dynamicPlugins[name]||[];depends.push(name);var length=depends.length;var count=0;var f=function(){var n=depends[count];if(count++<length){installDynPlugin(n,f)}else{$.fn[name].apply(scope,arguments)}};f();return this}})()}(function(){var cache={};$.scriptlet=function scriptlet(str,data){var fn=!/\W/.test(str)?cache[str]=cache[str]||scriptlet($(str).html()):new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+str.replace(/[\r\t\n]/g," ").split("<%").join("\t").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("\t").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return data?fn(data):fn}})(jQuery);var components={controls:{},themes:{},behaviors:{},layouts:{}};AppC.register=function(type,name,fn){var e=components[type+"s"][name];if(!e){e={pend:[],factory:fn};components[type+"s"][name]=e}e.factory=fn;$.each(e.pend,function(){var instance=createControl(this.el,name,this.opts,this.fn);if(!instance){$.error("framework error - instance not returned from factory for: "+name)}var render=instance.render;var el=this.el;var opts=this.opts;instance.render=function(){if(arguments.length==1){render.apply(instance,[el,arguments[0]])}else{render.apply(instance,arguments)}el.trigger("rendered",instance)};el.data("control",instance);el.trigger("created",[instance,this.opts]);$.each(instance.getAttributes(),function(){switch(this.type){case AppC.Types.condition:var name="on"+$.proper(this.name);App.regCond(new RegExp("^("+this.name+")$"),function(meta){var bindFn=function(args){var scope=$(this);args=args||{};args.id=$(this).attr("id");App.triggerAction(scope,args,meta)};el.bind(name,bindFn);el.trash(function(){el.unbind(name,bindFn)})});break;case AppC.Types.action:break;default:var v=opts[this.name]||this.defaultValue;if(typeof (v)=="undefined"&&!this.optional){el.trigger("onError","required property '"+this.name+"' not found or missing value")}opts[this.name]=v}});if(this.fn){this.fn.call(instance,opts)}instance.render.apply(instance,[this.el,opts])})};function createControl(el,name,opts,fn){var e=components.controls[name];opts=opts||{};if(e){if(!e.factory){e.pend.push({el:el,fn:fn,opts:opts});return }var instance=e.factory.create();return instance}e={pend:[{el:el,fn:fn,opts:opts}],factory:null};components.controls[name]=e;load("control",name,e)}function load(type,name,e){var uri=AppC.docRoot+"components/"+type+"s/"+name+"/"+name+".js";$.getScript(uri)}$.fn.control=function(name,opts,fn){if(arguments.length==0){return this.data("control")}if(typeof (opts)=="function"){fn=opts;opts={}}createControl($(this),name,opts,fn);return this};$.fn.theme=function(name,options){return this};$.fn.behavior=function(name,options){return this};$.fn.layout=function(name,options){return this};App.reg("set","*",function(value,state){var el=$(this);var visibility=el.css("visibility")||"visible";var show=false,initial=true;if(visibility=="visible"){el.css("visibility","hidden");show=true}el.addClass("container");var bindFn=function(){el.compileChildren(state,false);if(show){$(this).css("visibility",visibility);show=false}if(initial){initial=false;App.checkState(state,el)}};el.bind("rendered",bindFn);el.trash(function(){el.unbind("rendered",bindFn)});$.each($.smartSplit(value," and "),function(){var idx=this.indexOf("[");if(idx<0){throw new "invalid set expression. must be in the form: control[type]"}var lastIdx=this.lastIndexOf("]");var ui=this.substring(0,idx);var params=this.substring(idx+1,lastIdx);var comma=params.indexOf(",");var type=null,args={};if(comma<0){type=params}else{type=params.substring(0,comma);args=App.getParameters(params.substring(comma+1),true);for(var p in args){args[p]=App.getEvaluatedValue(args[p])}}$.info("creating component of type="+type+",ui="+ui+",args="+$.toJSON(args));el[ui](type,args)})},true);var ua=navigator.userAgent.toLowerCase();AppC.UA={supported:false,opera:(ua.indexOf("opera")>-1),safari:(ua.indexOf("safari")>-1),safari2:false,safari3:false,IE:!!(window.ActiveXObject),IE6:false,IE7:false,IE8:false,windows:false,mac:false,linux:false,sunOS:false,platform:"unknown",flash:false,flashVersion:0,silverlight:false,sliverlightVersion:0};if(AppC.UA.IE){var arVersion=navigator.appVersion.split("MSIE");var version=parseFloat(arVersion[1]);AppC.UA.IE6=version>=6&&version<7;AppC.UA.IE7=version>=7&&version<8;AppC.UA.IE8=version>=8&&version<9}else{if(AppC.UA.safari){var webKitFields=RegExp("( applewebkit/)([^ ]+)").exec(ua);if(webKitFields[2]>400&&webKitFields[2]<500){AppC.UA.safari2=true}else{if(webKitFields[2]>500&&webKitFields[2]<600){AppC.UA.safari3=true}}}}AppC.UA.gecko=!AppC.UA.safari&&(ua.indexOf("gecko")>-1);AppC.UA.camino=AppC.UA.gecko&&ua.indexOf("camino")>-1;AppC.UA.firefox=AppC.UA.gecko&&(ua.indexOf("firefox")>-1||AppC.UA.camino||ua.indexOf("minefield")>-1||ua.indexOf("granparadiso")>-1||ua.indexOf("bonecho")>-1);AppC.UA.IPhone=AppC.UA.safari&&ua.indexOf("iphone")>-1;AppC.UA.mozilla=AppC.UA.gecko&&ua.indexOf("mozilla/")>-1;AppC.UA.webkit=AppC.UA.mozilla&&AppC.UA.gecko&&ua.indexOf("applewebkit")>0;AppC.UA.seamonkey=AppC.UA.mozilla&&ua.indexOf("seamonkey")>-1;AppC.UA.prism=AppC.UA.mozilla&&ua.indexOf("prism/")>0;AppC.UA.iceweasel=AppC.UA.mozilla&&ua.indexOf("iceweasel")>0;AppC.UA.epiphany=AppC.UA.mozilla&&ua.indexOf("epiphany")>0;AppC.UA.fluid=(window.fluid!=null);AppC.UA.gears=(window.google&&google.gears)!=null;AppC.UA.chromium=AppC.UA.webkit&&ua.indexOf("chrome/")>0;if(ua.indexOf("windows")!=-1||ua.indexOf("win32")!=-1){AppC.UA.windows=true;AppC.UA.platform="win32"}else{if(ua.indexOf("macintosh")!=-1||ua.indexOf("mac os x")!=-1){AppC.UA.mac=true;AppC.UA.platform="mac"}else{if(ua.indexOf("linux")!=-1){AppC.UA.linux=true;AppC.UA.platform="linux"}else{if(ua.indexOf("sunos")!=-1){AppC.UA.sunOS=true;AppC.UA.platform="sun"}}}}AppC.UA.silverlight=false;AppC.UA.silverlightVersion=0;function checkForSilverlight(){var container=null;try{var control=null;if(window.ActiveXObject){control=new ActiveXObject("AgControl.AgControl")}else{if(navigator.plugins["Silverlight Plug-In"]){container=document.createElement("div");document.body.appendChild(container);container.innerHTML='<embed type="application/x-silverlight" src="data:," />';control=container.childNodes[0]}}if(control){if(control.isVersionSupported("2.0")){AppC.UA.silverlightVersion=2}else{if(control.isVersionSupported("1.0")){AppC.UA.silverlightVersion=1}}AppC.UA.silverlight=AppC.UA.silverlightVersion>0}}catch(e){}if(container){try{document.body.removeChild(container)}catch(E){}}}if(AppC.UA.IE){try{var flash=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");var ver=flash.GetVariable("$version");var idx=ver.indexOf(" ");var tokens=ver.substring(idx+1).split(",");var version=tokens[0];AppC.UA.flashVersion=parseInt(version);AppC.UA.flash=true}catch(e){}}else{var plugin=navigator.plugins&&navigator.plugins.length;if(plugin){plugin=navigator.plugins["Shockwave Flash"]||navigator.plugins["Shockwave Flash 2.0"];if(plugin){if(plugin.description){var ver=plugin.description;AppC.UA.flashVersion=parseInt(ver.charAt(ver.indexOf(".")-1));AppC.UA.flash=true}else{AppC.UA.flashVersion=7;AppC.UA.flash=true}}}else{plugin=(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)?navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin:0;if(plugin&&plugin.description){AppC.UA.flash=true;AppC.UA.flashVersion=parseInt(plugin.description.substring(plugin.description.indexOf(".")-1))}}}$.each("firefox IE6 IE7 IE8 safari chromium webkit opera camino seamonkey prism fluid iceweasel epiphany".split(" "),function(){if(AppC.UA[this]===true){AppC.UA.supported=true;var name=this.toLowerCase();AppC.beforeCompile(function(body){checkForSilverlight();if(AppC.UA.platform){body.addClass(AppC.platform)}body.addClass(name);for(var p in AppC.UA){var v=AppC.UA[p];if(typeof (v)=="boolean"&&v===true&&p!="supported"&&p!="flash"&&p!="silverlight"){body.addClass(p.toLowerCase())}}if(AppC.UA.IPhone){body.addClass("width_narrow");body.addClass("height_short")}else{function calcDim(){var cn=body.attr("class");if(cn){$.each(cn.split(" "),function(){if(/^(height|width)_/.test(this)){body.removeClass(this)}})}var width=$(document).width();var height=$(document).height();if(height<480){body.addClass("height_tiny")}else{if(height>=480&&height<=768){body.addClass("height_small")}else{if(height>768&&height<1100){body.addClass("height_medium")}else{if(height>=1100){body.addClass("height_large")}}}}if(width<=640){body.addClass("width_tiny")}else{if(width>640&&width<=1024){body.addClass("width_small")}else{if(width>1024&&width<=1280){body.addClass("width_medium")}else{if(width>1280){body.addClass("width_large")}}}}}$(window).bind("resize",calcDim);calcDim()}});return false}});App.UUID={dateSeed:(started||new Date).getTime(),convert:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],base16:function(number){var output=null;if(number<16){output=this.convert[number]}else{var MSD=""+Math.floor(number/16);var LSD=number-MSD*16;if(MSD>=16){output=this.base16(MSD)+this.convert[LSD]}else{output=this.convert[MSD]+this.convert[LSD]}}return output},newID:function(){var dg=new Date(1970,9,22,0,0,0,0);var t=this.base16(this.dateSeed-dg.getTime());var a=this.base16(Math.floor(999999999999*Math.random()));var _b=App.MD5.hex_md5(window.location.pathname);var b=(_b.length>10?_b.substring(0,10):_b).gsub(/[^a-zA-Z0-9]/,"0");var c=this.base16(Math.round(this.dateSeed*Math.random()));return t+"-"+a+"-"+b+"-"+c}};var currentAddFn=$.fn.add;$.fn.add=function(prop,value){if(arguments.length==2&&typeof (prop)=="string"){switch(prop){case"class":case"className":this.addClass(value);break;default:this.attr(prop,value)}return this}else{return currentAddFn.apply(this,arguments)}};$.fn.remove=function(prop){$.each(this,function(){switch(prop){case"class":case"className":$(this).removeClass(prop);break;default:$(this).removeAttr(prop)}});return this};$.fn.after=function(t,f){var time=App.timeFormat(t);var scope=this;setTimeout(function(){f.call(scope)},time);return this};(function(jQuery){jQuery.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(i,attr){jQuery.fx.step[attr]=function(fx){if(fx.state==0){fx.start=getColor(fx.elem,attr);fx.end=getRGB(fx.end)}fx.elem.style[attr]="rgb("+[Math.max(Math.min(parseInt((fx.pos*(fx.end[0]-fx.start[0]))+fx.start[0]),255),0),Math.max(Math.min(parseInt((fx.pos*(fx.end[1]-fx.start[1]))+fx.start[1]),255),0),Math.max(Math.min(parseInt((fx.pos*(fx.end[2]-fx.start[2]))+fx.start[2]),255),0)].join(",")+")"}});function getRGB(color){var result;if(color&&color.constructor==Array&&color.length==3){return color}if(color=="transparent"){return[255,255,255]}if(result=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color)){return[parseInt(result[1]),parseInt(result[2]),parseInt(result[3])]}if(result=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color)){return[parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55]}if(result=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color)){return[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]}if(result=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color)){return[parseInt(result[1]+result[1],16),parseInt(result[2]+result[2],16),parseInt(result[3]+result[3],16)]}return colors[jQuery.trim(color).toLowerCase()]}function getColor(elem,attr){var color;do{color=jQuery.curCSS(elem,attr);if(color!=""&&color!="transparent"||jQuery.nodeName(elem,"body")){break}attr="backgroundColor"}while(elem=elem.parentNode);return getRGB(color)}var colors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})($);var oldBind=$.fn.bind;$.fn.bind=function(){if(arguments.length>1){return oldBind.apply(this,arguments)}else{var obj=arguments[0];$.each(this,function(idx){var t=$(this).get(idx);$.each($(t).children(),function(){var child=$(this);var name=child.attr("name");var value=name?obj[name]:obj[child.attr("id")];if(value){child.val(value)}})})}return this};$.fn.disable=function(){$.each(this,function(idx){$(this).attr("disabled",true)})};$.fn.enable=function(){$.each(this,function(){$(this).removeAttr("disabled")})};var validators={},decorators={},fieldsets={};var validatorMonitor=null;var validatorMonitors=null;var validatorMonitorRate=250;AppC.setFieldMonitorInterval=function(rate){validatorMonitorRate=rate;if(validatorMonitor){clearInterval(validatorMonitor);validatorMonitor=setInterval(fieldMonitor,validatorMonitorRate)}};AppC.addValidator=function(name,fn){validators[name]=fn};AppC.getValidator=function(name){if(name){return validators[name]}};AppC.validators=function(iter){for(var p in validators){iter.call({name:p,fn:validators[p]})}};AppC.addDecorator=function(name,fn){decorators[name]=fn};App.getDecorator=function(name){if(name){return decorators[name]}};AppC.decorators=function(iter){for(var p in decorators){iter.call({name:p,fn:decorators[p]})}};AppC.addValidator("required",function(el,value){return(typeof (value)!="undefined"&&value)});function installDecorator(el,target){if(!target){var img=AppC.docRoot+"images/exclamation.png";var id=el.attr("id")+"_decorator";var html='<span id="'+id+'" class="decorator"><img src="'+img+'"/></span>';el.after(html);target=$("#"+id);el.data("decoratorTarget",target)}return target}AppC.addDecorator("required",function(el,valid,value,target){target=installDecorator(el,target);if(valid){el.css("background-color","");target.css("visibility","hidden")}else{el.css("background-color","#FFEEEE");target.css("visibility","visible")}});AppC.addDecorator("custom",function(el,valid,value,target){target.css("visibility",valid?"hidden":"visible")});function fieldMonitor(){if(validatorMonitors&&validatorMonitors.length>0){$.each(validatorMonitors,function(){$(this).revalidate(true)})}}function startFieldMonitor(el){if(!validatorMonitors){validatorMonitors=[];validatorMonitor=setInterval(fieldMonitor,validatorMonitorRate)}validatorMonitors.push(el);var fn=function(){stopFieldMonitor(el)};el.data("fieldMonitor",fn);el.bind("blur",fn)}function stopFieldMonitor(el){if(validatorMonitors){var idx=validatorMonitors.indexOf(el);var idx=$.inArray(el,validatorMonitors);if(idx!=-1){validatorMonitors.splice(idx,1)}var fn=el.data("fieldMonitor");if(fn){el.unbind("blur",fn)}el.removeData("fieldMonitor")}}function makeFormEntry(array,name,e,fn){$.each(array,function(idx){var el=$(this);el.data(name,e);if(fn){fn(el)}el.revalidate()});return array}function fieldDecorate(el,valid,value){if(!value){el.addClass("validator_empty").removeClass("validator_value")}else{el.removeClass("validator_empty").addClass("validator_value")}if(valid){el.removeClass("validator_invalid").addClass("validator_valid")}else{el.addClass("validator_invalid").removeClass("validator_valid")}var dec=el.data("decorator");var target=el.data("decoratorTarget");var fn=typeof (dec)=="function"?dec:App.getDecorator(dec);return fn?fn(el,valid,value,target):null}function fieldActivate(el,activator,activators){activator=activator?activator:el.data("activator");if(activator){var valid=true;var array=activators?activators:activator.data("activators");$.each(array,function(){var r=$("#"+this).data("validatorResult");if(r===false){valid=false;return false}});if(valid){activator.removeAttr("disabled")}else{activator.attr("disabled",true)}}}function fieldRevalidate(el,changeOnly,ignoreActivate){var v=el.data("validator");if(v){var result=false;var validator=typeof (v)=="function"?v:AppC.getValidator(v);if(validator){try{var value=getElementValue(el);if(changeOnly&&el.data("validatorData")===value){return }el.data("validatorData",value);result=validator(el,value);result=(typeof (result)=="undefined"?true:result)?true:false;el.data("validatorResult",result);fieldDecorate(el,result,value);if(!ignoreActivate){fieldActivate(el)}}catch(E){$.error("error in validation = "+E+" for element = "+el.attr("id"))}}}else{var activators=el.data("activators");if(activators){fieldActivate(null,el,activators)}}}$.fn.revalidate=function(changeOnly){return $.each(this,function(idx){fieldRevalidate($(this),changeOnly)});return this};$.fn.validator=function(v){makeFormEntry(this,"validator",v,function(el){if(el.is(":text,textarea")){el.bind("focus",function(){startFieldMonitor(el)})}else{if(el.is("select,:radio,:checkbox")){el.bind("click",function(){el.revalidate()})}}});return this};$.fn.decorator=function(d,decId){var dec=decId?(typeof (decId)=="string"?$("#"+decId):$(decId)):null;var fn=dec?function(el){el.data("decoratorTarget",dec)}:null;return makeFormEntry(this,"decorator",d,fn)};$.fn.activators=function(a){var self=this;var array=(typeof (a)=="string"?a.split(/[ ,]/):$.makeArray(a)).map(function(e){return $.trim(e)});this.data("activators",array);$.each(array,function(idx){var el=$("#"+$.trim(this));if(!el){$.error("Error adding activator field with id: "+this+", not found");return }el.data("activator",self)});this.revalidate();return this};$.fn.fieldset=function(fs){var array=(typeof (fs)=="string"?fs.split(/[ ,]/):$.makeArray(fs)).map(function(e){return $.trim(e)});$.each(this,function(idx){var el=$(this);if(!el){$.error("Error adding fieldset field with id: "+$(this).attr("id")+", not found");return }el.data("fieldsets",array);$.each(array,function(){App.addToFieldset(el,$.trim(this))})})};App.addToFieldset=function(el,fs){var elements=fieldsets[fs];if(!elements){elements=[];fieldsets[fs]=elements}elements.push(el)};App.getFieldsetData=function(fs,obj){obj=obj||{};var array=typeof (fs)=="string"?[fs]:fs.data("fieldsets");if(array&&array.length>0){$.each(array,function(){var elements=fieldsets[this];if(elements){$.each(elements,function(){var el=this;if(!el.is(":button")){var value=getElementValue(el);var key=el.is("form")?el.attr("name")||el.attr("fieldset")||el.attr("id"):el.attr("name")||el.attr("id");obj[key]=value}})}})}return obj};App.reg("validator",["input","button","select","textarea"],function(value,state){$(this).validator(value)});App.reg("decorator",["input","button","select","textarea"],function(value,state){$(this).decorator(value,$(this).attr("decoratorId"))});App.reg("activators",["div","input","button"],function(value,state){$(this).activators(value)});App.reg("fieldset",["form","input","button","select","textarea"],function(value,state){$(this).fieldset(value)});var oldVal=$.fn.val;$.fn.val=function(){var inr=this.data("revalidating");var rev=false;if(!inr){rev=true;this.data("revalidating",true)}var r=oldVal.apply(this,arguments);if(rev){this.revalidate();this.removeData("revalidating")}return r};regCSSAction("hidden","visibility");$.fn.highlight=function(bgColor){bgColor=bgColor||"#ffffcc";$.each(this,function(){var curBgColor=$(this).css("backgroundColor");$(this).animate({backgroundColor:bgColor},50).animate({backgroundColor:curBgColor},1000)});return this};App.dynregAction("history");
/*
(c) Copyrights 2007 - 2008

Original idea by by Binny V A, http://www.openjs.com/scripts/events/keyboard_shortcuts/
 
jQuery Plugin by Tzury Bar Yochay 
tzury.by@gmail.com
http://evalinux.wordpress.com
http://facebook.com/profile.php?id=513676303

Project's sites: 
http://code.google.com/p/js-hotkeys/
http://github.com/tzuryby/hotkeys/tree/master

License: same as jQuery license. 

USAGE:
    // simple usage
    $(document).bind('keydown', 'Ctrl+c', function(){ alert('copy anyone?');});
    
    // special options such as disableInIput
    $(document).bind('keydown', {combi:'Ctrl+x', disableInInput: true} , function() {});
    
Note:
    This plugin wraps the following jQuery methods: $.fn.find, $.fn.bind and $.fn.unbind
    
*/
jQuery.fn.__bind__=jQuery.fn.bind;jQuery.fn.__unbind__=jQuery.fn.unbind;jQuery.fn.__find__=jQuery.fn.find;var hotkeys={version:"0.7.8",override:/keydown|keypress|keyup/g,triggersMap:{},specialKeys:{27:"esc",9:"tab",32:"space",13:"return",8:"backspace",145:"scroll",20:"capslock",144:"numlock",19:"pause",45:"insert",36:"home",46:"del",35:"end",33:"pageup",34:"pagedown",37:"left",38:"up",39:"right",40:"down",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12"},shiftNums:{"`":"~","1":"!","2":"@","3":"#","4":"$","5":"%","6":"^","7":"&","8":"*","9":"(","0":")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},newTrigger:function(type,combi,callback){var result={};result[type]={};result[type][combi]={cb:callback,disableInInput:false};return result}};if(jQuery.browser.mozilla){hotkeys.specialKeys=jQuery.extend(hotkeys.specialKeys,{96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"})}jQuery.fn.find=function(selector){this.query=selector;return jQuery.fn.__find__.apply(this,arguments)};jQuery.fn.unbind=function(type,combi,fn){if(jQuery.isFunction(combi)){fn=combi;combi=null}if(combi&&typeof combi==="string"){var selectorId=((this.prevObject&&this.prevObject.query)||(this[0].id&&this[0].id)||this[0]).toString();var hkTypes=type.split(" ");for(var x=0;x<hkTypes.length;x++){delete hotkeys.triggersMap[selectorId][hkTypes[x]][combi]}}return this.__unbind__(type,fn)};jQuery.fn.bind=function(type,data,fn){var handle=type.match(hotkeys.override);if(jQuery.isFunction(data)||!handle){return this.__bind__(type,data,fn)}else{var result=null,pass2jq=jQuery.trim(type.replace(hotkeys.override,""));if(pass2jq){result=this.__bind__(pass2jq,data,fn)}if(typeof data==="string"){data={combi:data}}if(data.combi){for(var x=0;x<handle.length;x++){var eventType=handle[x];var combi=data.combi.toLowerCase(),trigger=hotkeys.newTrigger(eventType,combi,fn),selectorId=((this.prevObject&&this.prevObject.query)||(this[0].id&&this[0].id)||this[0]).toString();trigger[eventType][combi].disableInInput=data.disableInInput;if(!hotkeys.triggersMap[selectorId]){hotkeys.triggersMap[selectorId]=trigger}else{if(!hotkeys.triggersMap[selectorId][eventType]){hotkeys.triggersMap[selectorId][eventType]=trigger[eventType]}}var mapPoint=hotkeys.triggersMap[selectorId][eventType][combi];if(!mapPoint){hotkeys.triggersMap[selectorId][eventType][combi]=[trigger[eventType][combi]]}else{if(mapPoint.constructor!==Array){hotkeys.triggersMap[selectorId][eventType][combi]=[mapPoint]}else{hotkeys.triggersMap[selectorId][eventType][combi][mapPoint.length]=trigger[eventType][combi]}}this.each(function(){var jqElem=jQuery(this);if(jqElem.attr("hkId")&&jqElem.attr("hkId")!==selectorId){selectorId=jqElem.attr("hkId")+";"+selectorId}jqElem.attr("hkId",selectorId)});result=this.__bind__(handle.join(" "),data,hotkeys.handler)}}return result}};hotkeys.findElement=function(elem){if(!jQuery(elem).attr("hkId")){if(jQuery.browser.opera||jQuery.browser.safari){while(!jQuery(elem).attr("hkId")&&elem.parentNode){elem=elem.parentNode}}}return elem};hotkeys.handler=function(event){var target=hotkeys.findElement(event.currentTarget),jTarget=jQuery(target),ids=jTarget.attr("hkId");if(ids){ids=ids.split(";");var code=event.which,type=event.type,special=hotkeys.specialKeys[code],character=!special&&String.fromCharCode(code).toLowerCase(),shift=event.shiftKey,ctrl=event.ctrlKey,alt=event.altKey||event.originalEvent.altKey,mapPoint=null;for(var x=0;x<ids.length;x++){if(hotkeys.triggersMap[ids[x]][type]){mapPoint=hotkeys.triggersMap[ids[x]][type];break}}if(mapPoint){var trigger;if(!shift&&!ctrl&&!alt){trigger=mapPoint[special]||(character&&mapPoint[character])}else{var modif="";if(alt){modif+="alt+"}if(ctrl){modif+="ctrl+"}if(shift){modif+="shift+"}trigger=mapPoint[modif+special];if(!trigger){if(character){trigger=mapPoint[modif+character]||mapPoint[modif+hotkeys.shiftNums[character]]||(modif==="shift+"&&mapPoint[hotkeys.shiftNums[character]])}}}if(trigger){var result=false;for(var x=0;x<trigger.length;x++){if(trigger[x].disableInInput){var elem=jQuery(event.target);if(jTarget.is("input")||jTarget.is("textarea")||elem.is("input")||elem.is("textarea")){return true}}result=result||trigger[x].cb.apply(this,[event])}return result}}}};window.hotkeys=hotkeys;AppC.currentLocale=window.navigator.language||"en";var bundles={};AppC.locale=function(lang){if(lang==AppC.currentLocale){return }AppC.currentLocale=lang;if(!bundles[lang]){try{var url=AppC.docRoot+"localization/"+lang.toLowerCase()+".properties";$.debug("attempting to fetch "+url);$.ajax({url:url,cache:true,dataType:"text",type:"GET",async:true,success:function(prop){var endRE=/\\$/;var cont=false,key=null,value=null;var map={};$.each(prop.split("\n"),function(){if(cont){value+=value.substring(0,value.length-1);if(endRE.test(this)){return }map[key]=value;cont=false;key=value=null;return }var line=$.trim(this);if(line==""||line.charAt(0)=="#"){return }var tokens=line.split("=");var k=$.trim(tokens[0]);if(k.charAt(0)=="#"){return }var v=$.trim(tokens.length>1?tokens[1]:"");if(endRE.test(v)){cont=true;key=k;value=v.substring(0,v.length-1);return }map[k]=v});bundles[lang]=map;AppC.beforeCompile(function(){$("[@id]").localize(lang)});$(document).trigger("localized",lang)}})}catch(E){if(lang.indexOf("-")>0){return AppC.locale(lang.split("-")[0])}$.error("error loading language bundle for language = "+lang+", Exception = "+E)}}else{AppC.beforeCompile(function(){$("[@id]").localize(lang)});$(document).trigger("localized",lang)}};$.fn.localize=function(lang){if(this.length>1){$.each(this,function(){$(this).localize(lang)});return this}var id=$(this).attr("id");if(id!=null){var m=bundles[lang||AppC.currentLocale];if(m){var value=m[id];if(value){var el=$(this).get(0);switch(el.nodeName){case"INPUT":case"BUTTON":$(this).val(value);break;default:$(this).html(value);break}}}}return this};if(AppC.config.auto_locale){AppC.locale(AppC.currentLocale)}$.fn.move=function(params){$.each(this,function(){$(this).css("position","relative").animate({left:params.x||0,top:params.y||0},params.duration||1000)})};$.fn.on=function(value,state){var el=$(this);var isFn=typeof (state)=="function";if(isFn){value=value+" then script[true]"}var expr=App.parseExpression(value);$.each(expr,function(){var p=App.extractParameters(this[2]);var ep=isFn?null:this[3]?App.extractParameters(this[3]):null;var param={cond:this[1],action:isFn?state:p.name,actionParams:isFn?null:p.params,elseAction:ep?ep.name:null,elseActionParams:ep?ep.params:null,delay:this[4],ifCond:this[5],state:state};App.processCond(el,param)});return this};regCSSAction("opacity",function(params){var value=(typeof (params)=="string"||typeof (params)=="number")?params:(params?params.value:null);if(typeof (value)=="undefined"&&params){for(var p in params){if(p=="id"||p=="source"){continue}value=params[p];break}}if(typeof (value)=="undefined"){value=1}if(typeof (value)!="number"){value=parseFloat(value)}this.css("opacity",(value==1||value=="")?"1.0":(value<0.00001)?0:value)});var subs={local:[],remote:[]};var re=/^(l|local|both|r|remote|\*)\:(.*)$/;var localRe=/^l|local|both|\*/;var pubdebug=AppC.params.debug=="2"||AppC.params.debug=="1";var queue=[];var remoteDisabled=true;var queueInit=false;var processingQueue=false;$.fn.sub=function(name,fn,params){var p=App.extractParameters(name);params=params||p.params;name=App.normalizePub(p.name);var regexp=null;var m=re.exec(name);var type=m[2];if(type.charAt(0)=="~"){type=type.substring(1);regexp=new RegExp(type)}if(this.get(0)!=document){$(this).trash(function(){$(this).unsub(name,fn)})}$.debug("subscribing type="+type+", regexp="+regexp);if(localRe.test(m[1])){subs.local.push({scope:this,fn:fn,name:type,params:params,regexp:regexp})}else{subs.remote.push({scope:this,fn:fn,name:type,params:params,regexp:regexp})}return this};$.fn.unsub=function(name,fn){name=App.normalizePub(name);var match=re.exec(name);if(match){var array=match[1]=="remote"?subs.remote:subs.local;var type=match[2];var found=[];for(var c=0;c<array.length;c++){var entry=array[c];if(entry.name==type&&entry.fn==fn){found.push(c)}}for(var c=0;c<found.length;c++){array.splice(found[c],1)}}};App.normalizePub=function(name){var idx=name.indexOf("[");if(idx>0){name=name.substring(0,idx)}var m=re.exec(name);if(!m){return"both:"+name}switch(m[1]){case"l":case"local":return"local:"+m[2];case"r":case"remote":return"remote:"+m[2]}return"both:"+m[2]};App.pubQueue=function(name,data,local,scope,version){if(pubdebug){$.info("publish "+name+" with "+$.toJSON(data))}if(subs.local.length==0&&subs.remote.length==0){return }queue.push({data:data||{},name:name,local:local,scope:scope,version:version});if(remoteDisabled&&queueInit&&!processingQueue){processQueue()}};$.fn.pub=function(name,data,scope,version){var m=re.exec(name);var isLocal=localRe.test(m[1]);data=data||{};App.getFieldsetData(this,data);if(isLocal&&!data.event){data.event={id:$(this).attr("id")}}if(!isLocal&&data.event){delete data.event}App.pubQueue(m[2],data,isLocal,scope,version);return this};$(document).bind("compiled",function(){queueInit=true;processQueue()});App.regCond(re,function(meta){$(this).sub(meta.cond,function(data,scope,version,name,direction,params){if(App.parseConditionCondition(params,data)){App.triggerAction(this,data,meta)}else{App.triggerElseAction(this,data,meta)}})});App.regAction(/^(l|local|both|\*|r|remote)\:/,function(params,action){$(this).pub(action,params)});function deliverRemoteMessages(msgs){$.debug("remote messages received = "+$.toJSON(msgs));$.each(msgs,function(){var msg=this;$.each(subs.remote,function(){if((this.regexp&&this.regexp.test(msg.name))||(!this.regexp&&this.name==msg.name)){this.fn.apply(this.scope,[msg.data,msg.scope,msg.version,msg.name,"remote"])}})})}var instanceid=AppC.params.instanceid||App.MD5.hex_md5(String(new Date().getTime())+String(Math.round(9999*Math.random())));function getServiceURL(){var token=App.MD5.hex_md5(sessionCookie+instanceid);return serviceBroker+"?instanceid="+instanceid+"&auth="+token+"&ts="+String(new Date().getTime())}var marshallers={};var currentRequestId=0;marshallers["xml/json"]=function(q){var requestid=currentRequestId++;var xml="";var time=new Date;var timestamp=time.getTime();xml="<?xml version='1.0' encoding='UTF-8'?>\n";var tz=time.getTimezoneOffset()/60;var idleMs=0;xml+="<request version='1.0' idle='"+idleMs+"' timestamp='"+timestamp+"' tz='"+tz+"'>\n";$.each(q,function(){xml+="<message requestid='"+requestid+"' type='"+this.name+"' datatype='JSON' scope='"+(this.scope||"appcelerator")+"' version='"+(this.version||"1.0")+"'>";xml+="<![CDATA["+$.toJSON(this.data)+"]]>";xml+="</message>"});xml+="</request>";$.ajax({type:"POST",url:getServiceURL(),data:xml,cache:false,dataType:"xml",contentType:"text/xml",success:function(xml){var children=xml.documentElement.childNodes;if(children&&children.length>0){var msgs=[];for(var c=0;c<children.length;c++){var child=children.item(c);if(child.nodeType==1){var requestid=child.getAttribute("requestid");var type=child.getAttribute("type");var datatype=child.getAttribute("datatype");var scope=child.getAttribute("scope")||"appcelerator";var text=$.domText(child);var data=$.evalJSON(text);msgs.push({name:type,data:data,datatype:datatype,scope:scope,requestid:requestid})}}deliverRemoteMessages(msgs)}}})};marshallers["application/json"]=function(q){var requestid=this.currentRequestId++;var request={};var time=new Date;var json={timestamp:time.getTime()+(time.getTimezoneOffset()*60*1000),version:"1.0",messages:[]};for(var c=0,len=q.length;c<len;c++){var e=q[c];json.messages.push({type:e.name,data:e.data,version:e.version,scope:e.scope})}$.ajax({type:"POST",url:getServiceURL(),data:$.toJSON(json),cache:false,dataType:"json",contentType:"application/json",success:function(result){var msgs=[];for(var c=0;c<result.messages.length;c++){var message=result.messages[c];var type=message.type;var datatype=message.datatype;var scope=message.scope||"appcelerator";var data=message.data;message.datatype="JSON";msgs.push({name:type,data:data,datatype:datatype,scope:scope})}deliverRemoteMessages(msgs)}})};function remoteDelivery(q){if(!remoteDisabled){marshaller(q)}}function processQueue(){if(queue.length<1){return }var rq=remoteDisabled?null:[];processingQueue=true;for(var i=0;i<queue.length;i++){var a=queue[i].local?subs.local:subs.remote;var name=queue[i].name;var data=queue[i].data;var scope=queue[i].scope||"appcelerator";var version=queue[i].version||"1.0";var direction=queue[i].local?"local":"remote";for(var j=0;j<a.length;j++){if((a[j].regexp&&a[j].regexp.test(name))||(!a[j].regexp&&a[j].name==name)){a[j].fn.apply(a[j].scope,[data,scope,version,name,direction,a[j].params])}}}if(rq&&rq.length>0){remoteDelivery(rq)}queue=[];processingQueue=false}var queueTimer;var serviceBroker;var marshaller;var sessionCookie;function startDelivery(config){$.debug("remote config => "+$.toJSON(config));remoteDisabled=false;var sb=config.servicebroker;if(!sb||sb.disabled=="true"){remoteDisabled=true;$.info("Appcelerator remote services disabled");return }serviceBroker=sb.value;if(!serviceBroker){$.error("Error loading service broker! not specified in appcelerator.xml");remoteDisabled=true;return }if(!remoteDisabled){marshaller=marshallers[sb.marshaller];if(!marshaller){$.error("Error loading marshaller = "+sb.marshaller);remoteDisabled=true;return }var cookieName=config.sessionid.value||"unknown_cookie_name";var cookieValue=$.cookie(cookieName);if(!cookieValue){$.ajax({type:"GET",url:serviceBroker,data:"initial=1",async:true,success:function(){sessionCookie=$.cookie(cookieName);$.debug("sessionCookie = "+sessionCookie);queueTimer=setInterval(processQueue,10)}})}else{sessionCookie=cookieValue;$.debug("sessionCookie = "+sessionCookie);queueTimer=setInterval(processQueue,10)}}}try{AppC.serverConfig={};if(AppC.docRoot.indexOf("file:/")<0){var url=AppC.docRoot+"appcelerator.xml";$.ajax({async:true,cache:true,dataType:"xml",type:"GET",url:url,success:function(data){var re=/@\{(.*?)\}/g;var map={rootPath:AppC.docRoot};var children=data.documentElement.childNodes;for(var c=0;c<children.length;c++){var child=children[c];if(child.nodeType==1){var service=child.nodeName.toLowerCase();var config={};var path=$.domText(child);var template=AppC.compileTemplate(path,false,null,re);for(var x=0;x<child.attributes.length;x++){var attr=child.attributes[x];config[attr.name]=attr.value}config.value=template(map);AppC.serverConfig[service]=config}}$(document).trigger("serverConfig",AppC.serverConfig);startDelivery(AppC.serverConfig)},error:function(xhr,text,error){$.error("error retrieving appcelerator.xml, remote services are disabled. error = "+text)}})}}catch(e){$.error("error loading "+docRoot+"appcelerator.xml, remote services are disabled. error = "+e)}$.fn.pulsate=function(count){for(var i=0;i<(count||4);i++){this.fadeOut("fast").fadeIn("fast")}return this};regCSSAction("pulsate",function(params){return getTarget(params,this).pulsate(params.count)});$.each(["clear","reset","clearform"],function(){$.fn[this]=function(){$.each(this,function(){var target=$(this);var tag=App.getTagname(this);switch(tag){case"a":target.attr("href","#");break;case"form":this.reset();target.find(":input").revalidate();break;default:target.val("");break}});return this}});$.each(["script","function","javascript"],function(){$.fn[this]=function(code,scope){var js=code;if(typeof (js)=="string"){js=$.toFunction(js)}else{if(code.nodeType==1){js=$.toFunction($(code).html())}else{if(typeof (code.jquery)=="string"){js=$.toFunction(code.get(0).html())}else{throw"I don't know what this object is: "+(typeof (code))+" for "+$(this).attr("id")}}}js.call(scope||window);return this}});(function($){var $scrollTo=$.scrollTo=function(target,duration,settings){$(window).scrollTo(target,duration,settings)};$scrollTo.defaults={axis:"xy",duration:1};$scrollTo.window=function(scope){return $(window).scrollable()};$.fn.scrollable=function(){return this.map(function(){var win=this.parentWindow||this.defaultView,elem=this.nodeName=="#document"?win.frameElement||win:this,doc=elem.contentDocument||(elem.contentWindow||elem).document,isWin=elem.setInterval;return elem.nodeName=="IFRAME"||isWin&&$.browser.safari?doc.body:isWin?doc.documentElement:this})};$.fn.scrollTo=function(target,duration,settings){if(typeof duration=="object"){settings=duration;duration=0}if(typeof settings=="function"){settings={onAfter:settings}}settings=$.extend({},$scrollTo.defaults,settings);duration=duration||settings.speed||settings.duration;settings.queue=settings.queue&&settings.axis.length>1;if(settings.queue){duration/=2}settings.offset=both(settings.offset);settings.over=both(settings.over);return this.scrollable().each(function(){var elem=this,$elem=$(elem),targ=target,toff,attr={},win=$elem.is("html,body");switch(typeof targ){case"number":case"string":if(/^([+-]=)?\d+(px)?$/.test(targ)){targ=both(targ);break}targ=$(targ,this);case"object":if(targ.is||targ.style){toff=(targ=$(targ)).offset()}}$.each(settings.axis.split(""),function(i,axis){var Pos=axis=="x"?"Left":"Top",pos=Pos.toLowerCase(),key="scroll"+Pos,old=elem[key],Dim=axis=="x"?"Width":"Height",dim=Dim.toLowerCase();if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(settings.margin){attr[key]-=parseInt(targ.css("margin"+Pos))||0;attr[key]-=parseInt(targ.css("border"+Pos+"Width"))||0}attr[key]+=settings.offset[pos]||0;if(settings.over[pos]){attr[key]+=targ[dim]()*settings.over[pos]}}else{attr[key]=targ[pos]}if(/^\d+$/.test(attr[key])){attr[key]=attr[key]<=0?0:Math.min(attr[key],max(Dim))}if(!i&&settings.queue){if(old!=attr[key]){animate(settings.onAfterFirst)}delete attr[key]}});animate(settings.onAfter);function animate(callback){$elem.animate(attr,duration,settings.easing,callback&&function(){callback.call(this,target,settings)})}function max(Dim){var attr="scroll"+Dim,doc=elem.ownerDocument;return win?Math.max(doc.documentElement[attr],doc.body[attr]):elem[attr]}}).end()};function both(val){return typeof val=="object"?val:{top:val,left:val}}})(jQuery);App.regAction(evtRegex("selectOption"),function(params){$.error("not implemented")});var cssProperties=["border","padding","margin","color","cursor","font","fontFamily","visibility","position","overflow","filter","display","backgroundColor","backgroundPosition","backgroundAttachment","borderBottomColor","borderBottomStyle","borderBottomWidth","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRightColor","borderRightStyle","borderRightWidth","borderSpacing","borderTopColor","borderTopStyle","borderTopWidth","bottom","clip","color","fontSize","fontWeight","height","left","letterSpacing","lineHeight","marginBottom","marginLeft","marginRight","marginTop","markerOffset","maxHeight","maxWidth","minHeight","minWidth","opacity","outlineColor","outlineOffset","outlineWidth","paddingBottom","paddingLeft","paddingRight","paddingTop","right","textIndent","top","width","wordSpacing","zIndex"];$.fn.set=function(params){params=convertParams(params);$.each(this,function(){var target=$(this);var tag=App.getTagname(this);for(var p in params){switch(p){case"id":case"event":break;case"class":case"className":target.attr("class",params[p]);break;case"style":$.each(params[p].split(";"),function(){var t=this.split(":");if(t&&t.length>1){target.css(t[0],t[1]);return }});break;case"href":switch(tag){case"a":case"link":target.attr("href",URI.absolutizeURI(params[p],AppC.docRoot));break}case"src":switch(tag){case"iframe":case"script":case"image":var onload=target.attr("onloaded");if(onload){var done=false;el.onload=el.onreadystatechange=function(){if(!done&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")){done=true;target.pub(onload,{source:{id:el.id}},target.attr("scope"));el.onload=null}}}if(AppC.UA.opera){el.location.href=URI.absolutizeURI(params[p],AppC.docRoot)}else{el.src=URI.absolutizeURI(params[p],AppC.docRoot)}break;default:target.attr(p,params[p]);break}break;default:if(cssProperties.indexOf(p)!=-1||cssProperties.indexOf($.camel(p))!=-1){target.css(p,params[p])}else{target.attr(p,params[p])}}}})};$.fn.srcexpr=function(value){var srcvalue=eval($.unescapeXML(value));if(AppC.UA.IE6){}$(this).get(0).src=srcvalue;return this};App.regAction(evtRegex("statechange"),function(params){$.error("not implementing")});var testCases=[];var testPassed=0;var testFailed=0;var testErrored=0;var testListener=null;$.fn.assert=function(){var passed=true,error=null,stop=false,message=String(arguments[0]),expr=arguments[0];if(typeof (arguments[0])=="string"&&arguments.length==2){expr=arguments[1]}var type=typeof (expr);if(type=="boolean"){passed=expr;stop=true}else{if(type=="string"){expr=$.toFunction(expr)}else{passed=typeof (expr)!="undefined"?true:false;stop=true}}if(!stop){$.each(this,function(){try{var result=expr.call($(this));if(result!==true){passed=false;return false}}catch(E){passed=false;error=E;return false}})}var result={passed:passed,expr:String(expr),message:message,error:error};testCases.push(result);if(passed){testPassed++}if(error){testErrored++}if(!passed&&!error){testFailed++}if(testListener){testListener.result(result)}return this};$.fn.assertEnabled=function(){var passed=true;$.each(this,function(){var v=$(this).attr("disabled");if(v){passed=false;return false}});return this.assert(passed)};$.fn.assertDisabled=function(){var passed=true;$.each(this,function(){var v=$(this).attr("disabled");if(!v){passed=false;return false}});return this.assert(passed)};$.fn.assertCSS=function(key,val){var passed=true;$.each(this,function(){var v=$(this).css(key);if(v!=val){passed=false;return false}});return this.assert(passed)};$.fn.assertClass=function(className){var passed=true;$.each(this,function(){if($(this).hasClass(className)==false){passed=false;return false}});return this.assert(passed)};$.fn.assertAttr=function(attr){var passed=true;$.each(this,function(){if(!$(this).attr(attr)){passed=false;return false}});return this.assert(passed)};$.fn.assertValid=function(){var passed=true;$.each(this,function(){var v=$(this).data("validatorResult");if(!v){passed=false;return false}});return this.assert(passed)};$.fn.assertInvalid=function(){var passed=true;$.each(this,function(){var v=$(this).data("validatorResult");if(v){passed=false;return false}});return this.assert(passed)};var oldPub=App.pubQueue;var lastPubType=null,lastPubData=null;App.pubQueue=function(name,data,local,scope,version){lastPubType=(local?"local":"remote")+":"+name;lastPubData=data;return oldPub.apply(this,arguments)};$.fn.assertPub=function(name,data){name=App.normalizePub(name);if(typeof (data)=="undefined"){return this.assert(name+" was not correct. expected: "+name+", was: "+lastPubType,lastPubType===name)}if(name!==lastPubType){return this.assert(name+" was not correct. expected: "+name+", was: "+lastPubType,name===lastPubType)}if(!lastPubData){return this.assert(name+" missing data payload: "+$.toJSON(data),false)}for(var key in data){var v1=lastPubData[key];var v2=data[key];if(v1!==v2){return this.assert(name+" has incorrect data payload entry for key: "+key+", expected: "+v2+", was: "+v1,false)}}return this.assert(name,true)};var TestGuard=function(timeout,fn,cb){var count=0;var done=false;var timer=setTimeout(function(){if(count!=0){done=true;$(document).assert("test failed because it timed out",false);if(cb.timeout){cb.timeout()}$.error("test timed out");fn()}},timeout);this.begin=function(){if(done){return }count++;if(cb&&cb.begin){cb.begin(count)}};this.end=function(){if(done){return }count--;if(cb&&cb.end){cb.end(count)}if(count==0){clearTimeout(timer);done=true;timer=null;fn()}};this.assert=function(a,b){if(done){return }return $(document).assert(a,b)};this.assertPub=function(name,data){if(done){return }return $(document).assertPub(name,data)}};AppC.runTests=function(timeout,begin,end,cb){var timeout=typeof (timeout)!="number"?10000:timeout;begin=typeof (timeout)!="number"?timeout:begin;end=typeof (timeout)!="number"?begin:end;cb=typeof (timeout)!="number"?end:cb;testCases=[];testPassed=0;testFailed=0;testErrored=0;testListener=cb;var complete=function(){if(end){end({passed:testPassed,failed:testFailed,errored:testErrored,tests:testCases})}else{var count=testPassed+testFailed+testErrored;var msg="TEST RESULTS: "+count+" test"+(count>1?"s":"")+" executed: ";if(testFailed>0||testErrored>0){var r=[];if(testFailed){r.push(testFailed+" failed")}if(testErrored){r.push(testErrored+" errored")}r.push(testPassed+" passed");msg+=r.join(", ")}else{msg+="All Passed! Now go take a nice break."}$.info(msg);if(testFailed||testErrored){$.each(testCases,function(){if(this.error){$.error("ERROR: "+this.error+", message: "+this.message)}else{$.error("FAILED: "+this.expr+", message: "+this.message)}})}}};var guard=new TestGuard(timeout,complete,cb);guard.begin();begin(guard);guard.end()};$.fn.toggle=function(params){params=convertParams(params);$.each(this,function(){var target=$(this);for(var p in params){switch(p){case"id":case"event":break;case"className":case"class":target.toggleClass(params[p]);break;default:if(cssProperties.indexOf(p)!=-1||cssProperties.indexOf($.camel(p))!=-1){var currentVal=target.css(p);var opposites={inline:"none",block:"none",none:"block",hidden:"visible",visible:"hidden"};var opposite=opposites[currentVal]||"";if(currentVal==params[p]){target.css(p,opposite);break}else{target.css(p,params[p]);break}}else{if(target.attr(p)){target.removeAttr(p);break}else{target.attr(p,params[p]);break}}}}});return this};$.fn.trash=function(fn){var trash=this.data("trash");if(!trash){trash=[];this.data("trash",trash)}if(arguments.length==0||typeof (fn)=="undefined"){return trash}trash.push(fn);return this};$.fn.destroy=function(){var scope=$(this);if(!scope.attr("id")){return this}$.each(this,function(){var el=$(this);var trash=el.trash();if(trash&&trash.length>0){$.each(trash,function(){try{this.call(scope)}catch(E){}});el.trigger("destroyed")}el.removeData("trash")});return this};var oldEmpty=$.fn.empty;$.fn.empty=function(){var el=$(this).get(0);if(el){var set=getTargetCompileSet(el,true);$.each(set,function(){$(this).destroy()})}return oldEmpty.apply(this,arguments)};var oldRemove=$.fn.remove;$.fn.remove=function(){$.each(this,function(){var scope=$(this);scope.destroy();oldRemove.call(scope)});return this};$.fn.value=function(object,property,defValue){var value=$.getNestedProperty(object,property,defValue||property);if(this.is(":input")){this.val(value)}else{this.html(value)}return this};regCSSAction("visible","visibility");$.each(["add","remove"],function(){var action=this;App.regAction(evtRegex(action),function(params,name){var target=getTarget(params,this);for(var p in params){switch(p){case"id":case"event":break;default:target[action](p,params[p]);break}}return this})});App.regAction(evtRegex("cookie"),function(params){$.cookie(params.name,params.value,params)});App.regAction(evtRegex("disable"),function(params){return getTarget(params,this).disable()});App.handleBasicEffect=function(obj,action,params){var target=obj;var opts={},speed=0,easing=null;for(var p in params){switch(p){case"event":continue;case"id":target=$("#"+params[p]);break;case"speed":speed=params[p];break;case"easing":easing=params[p];break;default:opts[$.camel(p)]=params[p];break}}$.debug("effect="+action+",target="+target.attr("id")+",opts="+$.toJSON(opts)+",speed="+speed+",easing="+easing);switch(action){case"animate":var position=target.css("position");if(position!="relative"&&position!="absolute"){target.css("position","relative")}return target.animate(opts,speed,easing);case"fadeTo":return target.fadeTo(target,[speed,opts.opacity||opts.to||1]);default:return target[action].apply(target,[speed])}};$.fn.appear=function(){$.each(this,function(){$(this).fadeIn()});return this};$.fn.fade=function(){$.each(this,function(){$(this).fadeOut()});return this};$.each(["show","hide","slideToggle","slideUp","slideDown","fadeIn","fadeOut","fadeTo","animate","appear","fade"],function(){var name=$.string(this);App.regAction(evtRegex(name),function(params){return App.handleBasicEffect(getTarget(params,this),name,params)})});App.regAction(evtRegex("enable"),function(params){return getTarget(params,this).enable()});regCSSAction("move",function(params){return getTarget(params,this).move(params)});$.each(["clear","reset","clearform"],function(){var eventName=this;App.regAction(evtRegex(eventName),function(params,name,data){return getTarget(params,this)[eventName]()})});$.each(["script","function","javascript"],function(){var type=this;App.regAction(evtRegex(this),function(params,name,data){return getTarget(params,this)[type](data,params)},true)});App.regAction(evtRegex("value"),function(params,name,data){return getTarget(params,this).value(params,data)},true);App.regAction(evtRegex("bind"),function(params){var target=getTarget(params,this);var fieldset=target.attr("fieldset");if(!fieldset){$.error("bind action requires fieldset attribute");return this}this.find("[fieldset="+fieldset+"]").bind(params);return this});App.regAction(evtRegex("scrollTo"),function(params){var scrollTo=0;var duration=1000;var scrollToObj={};var useObj=false;var options={};var target=null;for(var p in params){switch(p){case"event":break;case"id":scrollTo=$("#"+params[p]);break;case"duration":duration=parseInt(params[p]);break;case"axis":options.axis=params[p];break;case"queue":options.queue=params[p];break;case"top":scrollToObj.top=params[p];useObj=true;break;case"left":scrollToObj.left=params[p];useObj=true;break;case"target":target=params[p];break;default:break}}if(target!=null){$("#"+target).scrollTo((useObj==true)?scrollToObj:scrollTo,duration,options)}else{$.scrollTo((useObj==true)?scrollToObj:scrollTo,duration,options)}});App.regAction(evtRegex("set"),function(){getTarget(params,this).set.apply(this,arguments);return this});App.regAction(evtRegex("toggle"),function(params){return getTarget(params,this).toggle(params)});regCSSAction("highlight",function(params){var bgColor=params["background-color"]||params.backgroundColor||"#ffffcc";return getTarget(params,this).highlight(bgColor)});App.reg("on","*",function(value,state){$(this).on(value,state)});var appuid=$.cookie("appuid");var staturi=(("https:"==document.location.protocol)?"https://s3.amazonaws.com/tracker.appcelerator.org/":"http://tracker.appcelerator.org/")+"app.js";if(!appuid){appuid=App.UUID.newID();$.cookie("appuid",appuid,{expires:31536000000*5,path:"/",domain:document.domain})}var _onerror=window.onerror,_sending=false;function TrackStat(evt,extra){if(AppC.config.track_stats){_sending=true;var d=new Date().getTime()-(started||new Date).getTime();var uri=staturi+"?t="+Number(new Date)+"&dur="+d+"&evt="+evt+"&appuid="+appuid+"&tid="+started.getTime()+"&"+(extra||"");try{$.getScript(uri)}catch(E){}_sending=false}}var errorCount=0;var errorMax=5;window.onerror=function(msg,url,line){if(_sending){return }try{if(url&&url.indexOf(staturi)!=-1){return }if(errorCount++>errorMax){return }if(!url&&!line&&typeof (msg)=="object"&&typeof (msg.stopPropagation)=="function"){_sending=false;return }$.error("generic uncaught error = "+String(msg)+", url = "+url+", line = "+line);var s="msg="+encodeURIComponent($.encode64(String(msg)))+"&url="+encodeURIComponent($.encode64(String(url||"")))+"&line="+encodeURIComponent(line||-1);TrackStat(2,s);if(_onerror){_onerror(msg,url,line)}}catch(e){$.error("caught error in window.onerror = "+e);_sending=false;return false}};$(document).bind("compiled",function(){var sendRemote=window.location.href.indexOf("file:/")!=-1&&AppC.config.report_stats;var screenHeight=screen.height;var screenWidth=screen.width;var colorDepth=screen.colorDepth||-1;var tz=started.getTimezoneOffset()/60;var cookies=[];$.each((document.cookie||"").split(";"),function(){var t=this.split("=");if(t.length>0){cookies.push({name:t[0],value:t[1]})}});var data={userAgent:navigator.userAgent,flash:AppC.UA.flash,flashver:AppC.UA.flashVersion,silverlight:AppC.UA.silverlight,silverlightver:AppC.UA.silverlightVersion,gears:AppC.UA.gears,fluid:AppC.UA.fluid,screen:{height:screenHeight,width:screenWidth,color:colorDepth},os:AppC.UA.platform,referrer:document.referrer,path:window.location.href,cookies:cookies,tz:tz,uid:appuid};setTimeout(function(){if(sendRemote){if(window.parent==null||window.parent==window){$(document).pub("r:appcelerator.status.report",data)}}var a=0,s=0,v=1,c=null,l=null,svc=null;c=AppC.serverConfig.aid;if(c){a=c.value}c=AppC.serverConfig.sid;if(c){s=c.value}c=AppC.serverConfig.language;if(c){l=c.value}c=AppC.serverConfig.service;if(c){svc=c.value}var p=AppC.UA.platform||"unknown";var f=AppC.UA.flashVersion;var sic=(AppC.serverConfig.sessionid||{}).value;var si=sic?$.cookie(sic):null;var qs=$.toQueryString({wv:String(AppC.Version),v:v,a:a,s:s,gg:Number(AppC.UA.gears),fd:Number(AppC.UA.fluid),dm:data.screen.width+","+data.screen.height+","+data.screen.color,p:AppC.UA.platform,tz:tz,fv:data.flashver,sv:data.silverlightver,r:$.encode64(document.referrer||""),t:$.encode64(document.title||""),si:si,sct:compileTime,slt:loadTime,bl:window.navigator.language,lng:l,svc:svc,js:$.encode64(jsLocation)});TrackStat(1,qs)},2000+Math.round(1999*Math.random()));$(window).unload(function(){TrackStat(0)})})})(jQuery);